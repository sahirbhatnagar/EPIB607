<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 21 Data Import and Export | EPIB607</title>
<meta name="author" content="Sahir Bhatnagar and James A Hanley">
<meta name="description" content="This section is adapted from The Epidemiologist R Handbook127 In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 21 Data Import and Export | EPIB607">
<meta property="og:type" content="book">
<meta property="og:url" content="https://sahirbhatnagar.com/EPIB607/import.html">
<meta property="og:description" content="This section is adapted from The Epidemiologist R Handbook127 In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 21 Data Import and Export | EPIB607">
<meta name="twitter:description" content="This section is adapted from The Epidemiologist R Handbook127 In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="templates/bs4_style.css">
<link rel="stylesheet" href="templates/ims-style.css">
<link rel="stylesheet" href="templates/corrections.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EPIB607</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="schedule.html">Schedule</a></li>
<li><a class="" href="syllabus.html">Syllabus</a></li>
<li class="book-part">Descriptive Statistics</li>
<li><a class="" href="introdata.html"><span class="header-section-number">1</span> Introduction to Data</a></li>
<li><a class="" href="aesthetic-mapping.html"><span class="header-section-number">2</span> Visualizing data: Mapping data onto aesthetics</a></li>
<li><a class="" href="coordinate-systems-axes.html"><span class="header-section-number">3</span> Coordinate systems and axes</a></li>
<li><a class="" href="ggplot2-package-for-plots.html"><span class="header-section-number">4</span> ggplot2 package for plots</a></li>
<li><a class="" href="color-basics.html"><span class="header-section-number">5</span> Color scales</a></li>
<li class="book-part">Sampling Distributions</li>
<li><a class="" href="paras.html"><span class="header-section-number">6</span> Statistical Parameters</a></li>
<li><a class="" href="ChapProbability.html"><span class="header-section-number">7</span> Probability</a></li>
<li><a class="" href="randomVariables.html"><span class="header-section-number">8</span> Random Variables</a></li>
<li><a class="" href="ChapNormal.html"><span class="header-section-number">9</span> The Normal Random Variable</a></li>
<li><a class="" href="ChapSampDist.html"><span class="header-section-number">10</span> The Sampling Distribution</a></li>
<li><a class="" href="CI.html"><span class="header-section-number">11</span> Parameter Intervals</a></li>
<li><a class="" href="foundations-bootstrapping.html"><span class="header-section-number">12</span> Confidence intervals with bootstrapping</a></li>
<li class="book-part">One Sample Inference</li>
<li><a class="" href="inference-one-mean.html"><span class="header-section-number">13</span> Inference for a single mean</a></li>
<li><a class="" href="ChapBinom.html"><span class="header-section-number">14</span> Binomial Random Variable</a></li>
<li><a class="" href="inference-one-prop.html"><span class="header-section-number">15</span> Inference for a single proportion</a></li>
<li class="book-part">Computing</li>
<li><a class="" href="install.html"><span class="header-section-number">16</span> Installing R and RStudio</a></li>
<li><a class="" href="basics.html"><span class="header-section-number">17</span> Basics of R and Rstudio</a></li>
<li><a class="" href="projects.html"><span class="header-section-number">18</span> RStudio Projects</a></li>
<li><a class="" href="functionsHOP.html"><span class="header-section-number">19</span> Functions</a></li>
<li><a class="" href="packages.html"><span class="header-section-number">20</span> Packages</a></li>
<li><a class="active" href="import.html"><span class="header-section-number">21</span> Data Import and Export</a></li>
<li><a class="" href="transition-to-r-from-excel-stata-sas.html"><span class="header-section-number">22</span> Transition to R from Excel, Stata, SAS</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="import" class="section level1">
<h1>
<span class="header-section-number">21</span> Data Import and Export<a class="anchor" aria-label="anchor" href="#import"><i class="fas fa-link"></i></a>
</h1>
<div class="rmdnote">
<p>This section is adapted from The Epidemiologist R Handbook<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Batra et al., &lt;em&gt;The Epidemiologist R Handbook&lt;/em&gt;.&lt;/p&gt;"><sup>127</sup></a></span></p>
</div>
<p>In this page we describe ways to locate, import, and export files:</p>
<ul>
<li>Use of the <strong>rio</strong> package to flexibly <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> many types of files<br>
</li>
<li>Use of the <strong>here</strong> package to locate files relative to an R project root - to prevent complications from file paths that are specific to one computer<br>
</li>
<li>Specific import scenarios, such as:
<ul>
<li>Specific Excel sheets<br>
</li>
<li>Messy headers and skipping rows<br>
</li>
<li>From Google sheets<br>
</li>
<li>From data posted to websites<br>
</li>
<li>With APIs<br>
</li>
<li>Importing the <em>most recent</em> file<br>
</li>
</ul>
</li>
<li>Manual data entry<br>
</li>
<li>R-specific file types such as RDS and RData<br>
</li>
<li>Exporting/saving files and plots</li>
</ul>
<!-- ======================================================= --><div id="overview-1" class="section level2">
<h2>
<span class="header-section-number">21.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-1"><i class="fas fa-link"></i></a>
</h2>
<p>When you import a “dataset” into R, you are generally creating a new <em>data frame</em> object in your R environment and defining it as an imported file (e.g. Excel, CSV, TSV, RDS) that is located in your folder directories at a certain file path/address.</p>
<p>You can import/export many types of files, including those created by other statistical programs (SAS, STATA, SPSS). You can also connect to relational databases.</p>
<p>R even has its own data formats:</p>
<ul>
<li>An RDS file (.rds) stores a single R object such as a data frame. These are useful to store cleaned data, as they maintain R column classes. Read more in <a href="import.html#import_rds">this section</a>.<br>
</li>
<li>An RData file (.Rdata) can be used to store multiple objects, or even a complete R workspace. Read more in <a href="import.html#import_rdata">this section</a>.</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="the-rio-package" class="section level2">
<h2>
<span class="header-section-number">21.2</span> The <strong>rio</strong> package<a class="anchor" aria-label="anchor" href="#the-rio-package"><i class="fas fa-link"></i></a>
</h2>
<p>The R package we recommend is: <strong>rio</strong>. The name “rio” is an abbreviation of “R I/O” (input/output).</p>
<p>Its functions <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> can handle many different file types (e.g. .xlsx, .csv, .rds, .tsv). When you provide a file path to either of these functions (including the file extension like “.csv”), <strong>rio</strong> will read the extension and use the correct tool to import or export the file.</p>
<p>The alternative to using <strong>rio</strong> is to use functions from many other packages, each of which is specific to a type of file. For example, <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> (<strong>base</strong> R), <code>read.xlsx()</code> (<strong>openxlsx</strong> package), and <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> (<strong>readr</strong> pacakge), etc. These alternatives can be difficult to remember, whereas using <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> from <strong>rio</strong> is easy.</p>
<p><strong>rio</strong>’s functions <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> use the appropriate package and function for a given file, based on its file extension. See the end of this page for a complete table of which packages/functions <strong>rio</strong> uses in the background. It can also be used to import STATA, SAS, and SPSS files, among dozens of other file types.</p>
</div>
<div id="here" class="section level2">
<h2>
<span class="header-section-number">21.3</span> The <strong>here</strong> package<a class="anchor" aria-label="anchor" href="#here"><i class="fas fa-link"></i></a>
</h2>
<p>The package <strong>here</strong> and its function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> make it easy to tell R where to find and to save your files - in essence, it builds file paths.</p>
<p>Used in conjunction with an [R Project][projects], <strong>here</strong> allows you to describe the location of files in your R Project in relation to the R Project’s <em>root directory</em> (the top-level folder). This is useful when the R project may be shared or accessed by multiple people/computers. It prevents complications due to the unique file paths on different computers (e.g. <code>"C:/Users/Laura/Documents..."</code> by “starting” the file path in a place common to all users (the R Project root). See Chapter <a href="projects.html#projects">18</a> for a reminder about R Projects.</p>
<p>This is how <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> works within an R Project:</p>
<ul>
<li>When the <strong>here</strong> package is first loaded within the R Project, it places a small file called “.here” in the root folder of your R project as a “benchmark” or “anchor”<br>
</li>
<li>In your scripts, to reference a file in the R project’s sub-folders, you use the function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> to build the file path <em>in relation to that anchor</em>
</li>
<li>To build the file path, write the names of folders beyond the root, within quotes, separated by commas, finally ending with the file name and file extension as shown below<br>
</li>
<li>
<code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> file paths can be used for both importing and exporting</li>
</ul>
<p>For example, below, the function <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> is being provided a file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelists"</span>, <span class="st">"ebola_linelist.xlsx"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The command <code>here::here("data", "linelists", "ebola_linelist.xlsx")</code> is actually providing the full file path that is <em>unique to the user’s computer</em>:</p>
<pre><code>"C:/Users/Laura/Documents/my_R_project/data/linelists/ebola_linelist.xlsx"</code></pre>
<p>The beauty is that the R command using <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> can be successfully run on any computer accessing the R project.</p>
<div class="rmdtip">
<p>If you are unsure where the “.here” root is set to, run the function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> with empty parentheses. Read more about the <strong>here</strong> package <a href="https://here.r-lib.org/">at this link</a>.</p>
</div>
<!-- ======================================================= -->
</div>
<div id="file-paths" class="section level2">
<h2>
<span class="header-section-number">21.4</span> File paths<a class="anchor" aria-label="anchor" href="#file-paths"><i class="fas fa-link"></i></a>
</h2>
<p>When importing or exporting data, you must provide a file path. You can do this one of three ways:</p>
<ol style="list-style-type: decimal">
<li>
<em>Recommended:</em> provide a “relative” file path with the <strong>here</strong> package<br>
</li>
<li>Provide the “full” / “absolute” file path<br>
</li>
<li>Manual file selection</li>
</ol>
<div id="relative-file-paths" class="section level3">
<h3>
<span class="header-section-number">21.4.1</span> “Relative” file paths<a class="anchor" aria-label="anchor" href="#relative-file-paths"><i class="fas fa-link"></i></a>
</h3>
<p>In R, “relative” file paths consist of the file path <em>relative to</em> the root of an R project. They allow for more simple file paths that can work on different computers (e.g. if the R project is on a shared drive or is sent by email). As described <a href="import.html#here">above</a>, relative file paths are facilitated by use of the <strong>here</strong> package.</p>
<p>An example of a relative file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> is below. In Figure <a href="import.html#fig:proj1">21.1</a> I show an example of a directory on my computer, with the <code>epib607.Rproj</code> file. This is referred to as the <strong>root directory</strong> of your project. All file paths will be relative to this directory. In this example the root directory is <code>/home/sahir/git_repositories/epib607</code>.</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inst"</span>,<span class="st">"figures"</span>,<span class="st">"proj1.png"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:proj1"></span>
<img src="inst/figures/proj1.png" alt="The files in my epib607 R project. (1) The R project file - this indicates that I have indeed created an R project called epib607. The .Rporj file is always found in the root directory. (2) The path of the directory as would be seen in a file management application such as Finder (on a mac) or Windows Explorer. (3) A directory that contains data." width="352"><p class="caption">
Figure 21.1: The files in my epib607 R project. (1) The R project file - this indicates that I have indeed created an R project called epib607. The .Rporj file is always found in the root directory. (2) The path of the directory as would be seen in a file management application such as Finder (on a mac) or Windows Explorer. (3) A directory that contains data.
</p>
</div>
<p>The data I want to load is in a sub-folder called “inst” and within that, a subfolder “data”, in which there is the <code>.rds</code> file of interest as shown in Figure <a href="import.html#fig:proj2">21.2</a></p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inst"</span>,<span class="st">"figures"</span>,<span class="st">"proj2.png"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:proj2"></span>
<img src="inst/figures/proj2.png" alt="The sub-folder containing the data I want to load. (1) linelist_cleaned.rds is the data file. (2) The path of the directory as would be seen in a file management application such as Finder (on a mac) or Windows Explorer. (3) Indicator that I am indeed in the RStudio project called epib607." width="392"><p class="caption">
Figure 21.2: The sub-folder containing the data I want to load. (1) linelist_cleaned.rds is the data file. (2) The path of the directory as would be seen in a file management application such as Finder (on a mac) or Windows Explorer. (3) Indicator that I am indeed in the RStudio project called epib607.
</p>
</div>
<p>To load the data, I simply call the <code><a href="https://rdrr.io/pkg/rio/man/import.html">rio::import()</a></code> function. This function requires the location of the data file. I use the <code><a href="https://here.r-lib.org//reference/here.html">here::here()</a></code> to locate the datafile:</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inst"</span>,<span class="st">"data"</span>, <span class="st">"linelist_cleaned.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="absolute-file-paths" class="section level3">
<h3>
<span class="header-section-number">21.4.2</span> “Absolute” file paths<a class="anchor" aria-label="anchor" href="#absolute-file-paths"><i class="fas fa-link"></i></a>
</h3>
<p>Absolute or “full” file paths can be provided to functions like <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> but they are “fragile” as they are unique to the user’s specific computer and therefore <em>not recommended</em>.</p>
<p>Below is an example of an absolute file path, where in Laura’s computer there is a folder “analysis”, a sub-folder “data” and within that a sub-folder “linelists”, in which there is the .xlsx file of interest.</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"/home/sahir/git_repositories/epib607/inst/data/linelist_cleaned.rds"</span><span class="op">)</span></code></pre></div>
<p>A few things to note about absolute file paths:</p>
<ul>
<li>
<strong>Avoid using absolute file paths</strong> as they will break if the script is run on a different computer</li>
<li>Use <em>forward</em> slashes (<code>/</code>), as in the example above (note: this is <em>NOT</em> the default for Windows file paths)<br>
</li>
<li>File paths that begin with double slashes (e.g. “//…”) will likely <strong>not be recognized by R</strong> and will produce an error. Consider moving your work to a “named” or “lettered” drive that begins with a letter (e.g. “J:” or “C:”).</li>
</ul>
<p>One scenario where absolute file paths may be appropriate is when you want to import a file from a shared drive that has the same full file path for all users.</p>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> To quickly convert all <code>\</code> to <code>/</code>, highlight the code of interest, use Ctrl+f (in Windows), check the option box for “In selection”, and then use the replace functionality to convert them.</span></p>
</div>
</div>
<div id="import-data-from-excel" class="section level2">
<h2>
<span class="header-section-number">21.5</span> Import data from Excel<a class="anchor" aria-label="anchor" href="#import-data-from-excel"><i class="fas fa-link"></i></a>
</h2>
<p>By default, if you provide an Excel workbook (.xlsx) to <code><a href="https://rdrr.io/pkg/rio/man/import.html">rio::import()</a></code>, the workbook’s first sheet will be imported. If you want to import a specific <strong>sheet</strong>, include the sheet name to the <code>which =</code> argument. For example:</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"my_excel_file.xlsx"</span>, which <span class="op">=</span> <span class="st">"Sheetname"</span><span class="op">)</span></code></pre></div>
<p>If using the <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> method to provide a relative pathway to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code>, you can still indicate a specific sheet by adding the <code>which =</code> argument after the closing parentheses of the <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> function.</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Demonstration: importing a specific Excel sheet when using relative pathways with the 'here' package</span>
<span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelist.xlsx"</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span>  </code></pre></div>
<!-- ======================================================= -->
</div>
<div id="import_missing" class="section level2">
<h2>
<span class="header-section-number">21.6</span> Missing values<a class="anchor" aria-label="anchor" href="#import_missing"><i class="fas fa-link"></i></a>
</h2>
<p>You may want to designate which value(s) in your dataset should be considered as missing. The value in R for missing data is <code>NA</code>, but perhaps the dataset you want to import uses 99, “Missing”, or just empty character space "" instead.</p>
<p>Use the <code>na =</code> argument for <code><a href="https://rdrr.io/pkg/rio/man/import.html">rio::import()</a></code> and provide the value(s) within quotes (even if they are numbers). You can specify multiple values by including them within a vector, using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> as shown below.</p>
<p>Here, the value “99” in the imported dataset is considered missing and converted to <code>NA</code> in R.</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"my_linelist.xlsx"</span><span class="op">)</span>, na <span class="op">=</span> <span class="st">"99"</span><span class="op">)</span></code></pre></div>
<p>Here, any of the values “Missing”, "" (empty cell), or " " (single space) in the imported dataset are converted to <code>NA</code> in R.</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"my_linelist.csv"</span><span class="op">)</span>, na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Missing"</span>, <span class="st">""</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="skip-rows" class="section level2">
<h2>
<span class="header-section-number">21.7</span> Skip rows<a class="anchor" aria-label="anchor" href="#skip-rows"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes, you may want to avoid importing a row of data. You can do this with the argument <code>skip =</code> if using <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> from <strong>rio</strong> on a .xlsx or .csv file. Provide the number of rows you want to skip.</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># does not import header row</span></code></pre></div>
<p>Unfortunately <code>skip =</code> only accepts one integer value, <em>not</em> a range (e.g. “2:10” does not work).</p>
<!-- ======================================================= -->
</div>
<div id="import-from-google-sheets" class="section level2">
<h2>
<span class="header-section-number">21.8</span> Import from Google sheets<a class="anchor" aria-label="anchor" href="#import-from-google-sheets"><i class="fas fa-link"></i></a>
</h2>
<p>You can import data from an online Google spreadsheet with the <strong>googlesheet4</strong> package and by authenticating your access to the spreadsheet.</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"googlesheets4"</span><span class="op">)</span></code></pre></div>
<p>Below, a demo Google sheet is imported and saved. This command may prompt confirmation of authentification of your Google account. Follow prompts and pop-ups in your internet browser to grant Tidyverse API packages permissions to edit, create, and delete your spreadsheets in Google Drive.</p>
<p>The sheet below is “viewable for anyone with the link” and you can try to import it.</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Gsheets_demo</span> <span class="op">&lt;-</span> <span class="fu">read_sheet</span><span class="op">(</span><span class="st">"https://docs.google.com/spreadsheets/d/1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY/edit#gid=0"</span><span class="op">)</span></code></pre></div>
<p>The sheet can also be imported using only the sheet ID, a shorter part of the URL:</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Gsheets_demo</span> <span class="op">&lt;-</span> <span class="fu">read_sheet</span><span class="op">(</span><span class="st">"1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY"</span><span class="op">)</span></code></pre></div>
<p>Another package, <strong>googledrive</strong> offers useful functions for writing, editing, and deleting Google sheets. For example, using the <code>gs4_create()</code> and <code>sheet_write()</code> functions found in this package.</p>
<p>Here are some other helpful online tutorials:<br><a href="https://arbor-analytics.com/post/getting-your-data-into-r-from-google-sheets/">basic Google sheets importing tutorial</a><br><a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">more detailed tutorial</a><br><a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">interaction between the googlesheets4 and tidyverse</a></p>
<!-- ======================================================= -->
</div>
<div id="import_github" class="section level2">
<h2>
<span class="header-section-number">21.9</span> Import from Github<a class="anchor" aria-label="anchor" href="#import_github"><i class="fas fa-link"></i></a>
</h2>
<p>Importing data directly from Github into R can be very easy or can require a few steps - depending on the file type. Below are some approaches:</p>
<div id="csv-files" class="section level3">
<h3>
<span class="header-section-number">21.9.1</span> CSV files<a class="anchor" aria-label="anchor" href="#csv-files"><i class="fas fa-link"></i></a>
</h3>
<p>It can be easy to import a .csv file directly from Github into R with an R command.</p>
<ol style="list-style-type: decimal">
<li>Go to the Github repo <a href="https://github.com/sahirbhatnagar/knitr-tutorial" class="uri">https://github.com/sahirbhatnagar/knitr-tutorial</a>, locate the file <code>001-motivating-example/fat-data.csv</code>, and click on it<br>
</li>
<li>Click on the “Raw” button (you will then see the “raw” csv data, as shown below)<br>
</li>
<li>Copy the URL (web address)<br>
</li>
<li>Place the URL in quotes within the <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> R command</li>
</ol>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="inst/gifs/git_data.gif" alt="Getting the link to data in .csv format from a GitHub repository." width="100%"><p class="caption">
Figure 14.4: Getting the link to data in .csv format from a GitHub repository.
</p>
</div>
<p>Once you’ve copied the URL address of the file, you can use the <code><a href="https://rdrr.io/pkg/rio/man/import.html">rio::import</a></code> function as follows:</p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/sahirbhatnagar/knitr-tutorial/master/001-motivating-example/fat-data.csv"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-bf4cd0dfb6b9dff3f587" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bf4cd0dfb6b9dff3f587">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251"],[12.6,6.9,24.6,10.9,27.8,20.6,19,12.8,5.1,12,7.5,8.5,20.5,20.8,21.7,20.5,28.1,22.4,16.1,16.5,19,15.3,15.7,17.6,14.2,4.6,8.5,22.4,4.7,9.4,12.3,6.5,13.4,20.9,31.1,38.2,23.6,27.5,33.8,31.3,33.1,31.7,30.4,30.8,8.4,14.1,11.2,6.4,13.4,5,10.7,7.4,8.7,7.1,4.9,22.2,20.1,27.1,30.4,24,25.4,28.8,29.6,25.1,31,28.9,21.1,14,7.1,13.2,23.7,9.4,9.1,13.7,12,18.3,9.2,21.7,21.1,18.6,30.2,26,18.2,26.2,26.1,25.8,15,22.6,8.8,14.3,20.2,18.1,9.2,24.2,9.6,17.3,10.1,11.1,17.7,21.7,20.8,20.1,19.8,21.9,24.7,17.8,19.1,18.2,17.2,21,19.5,27.1,21.6,20.9,25.9,16.7,19.8,14.1,25.1,17.9,27,24.6,14.8,16,14,17.4,26.4,17.4,20.4,15,18,22.2,23.1,25.3,23.8,26.3,21.4,28.4,21.8,20.1,24.3,18.1,22.7,9.9,10.8,14.4,19,28.6,6.1,24.5,9.9,19.1,10.6,16.5,20.5,17.2,30.1,10.5,12.8,22,9.9,14.8,13.3,15.2,26.5,19,21.4,20,34.7,16.5,4.1,1.9,20.2,16.8,24.6,10.4,13.4,28.8,22,16.8,25.8,11.9,12.4,17.4,9.2,23,20.1,20.2,23.8,11.8,36.5,16,24,22.3,24.8,21.5,17.6,7.3,22.6,12.5,21.7,27.7,6.8,33.4,16.6,31.7,31.5,10.1,11.3,7.8,26.4,19.3,18.5,19.3,45.1,13.8,8.2,23.9,15.1,12.7,25.3,11.9,6.1,11.3,12.8,14.9,24.5,15,16.9,11.1,16.1,15.5,25.9,25.5,18.4,24,26.4,12.7,28.8,17,33.6,29.3,31.4,28.1,15.3,29.1,11.5,32.3,28.3,25.3,30.7],[23,22,22,26,24,24,26,25,25,23,26,27,32,30,35,35,34,32,28,33,28,28,31,32,28,27,34,31,27,29,32,29,27,41,41,49,40,50,46,50,45,44,48,41,39,43,40,39,45,47,47,40,51,49,42,54,58,62,54,61,62,56,54,61,57,55,54,55,54,55,62,55,56,55,61,61,57,69,81,66,67,64,64,70,72,67,72,64,46,48,46,44,47,46,47,53,38,50,46,47,49,48,41,49,43,43,43,52,43,40,43,43,47,42,48,40,48,51,40,44,52,44,40,47,50,46,42,43,40,42,49,40,47,50,41,44,39,43,40,49,40,40,52,23,23,24,24,25,25,26,26,26,27,27,27,28,28,28,30,31,31,33,33,34,34,35,35,35,35,35,35,35,35,36,36,37,37,37,38,39,39,40,40,40,40,41,41,41,41,41,42,42,42,42,42,42,42,42,43,43,43,43,44,44,44,44,47,47,47,49,49,49,50,50,51,51,51,52,53,54,54,54,55,55,55,55,55,56,56,57,57,58,58,60,62,62,63,64,65,65,65,66,67,67,68,69,70,72,72,72,74],[154.25,173.25,154,184.75,184.25,210.25,181,176,191,198.25,186.25,216,180.5,205.25,187.75,162.75,195.75,209.25,183.75,211.75,179,200.5,140.25,148.75,151.25,159.25,131.5,148,133.25,160.75,182,160.25,168,218.5,247.25,191.75,202.25,196.75,363.15,203,262.75,205,217,212,125.25,164.25,133.5,148.5,135.75,127.5,158.25,139.25,137.25,152.75,136.25,198,181.5,201.25,202.5,179.75,216,178.75,193.25,178,205.5,183.5,151.5,154.75,155.25,156.75,167.5,146.75,160.75,125,143,148.25,162.5,177.75,161.25,171.25,163.75,150.25,190.25,170.75,168,167,157.75,160,176.75,176,177,179.75,165.25,192.5,184.25,224.5,188.75,162.5,156.5,197,198.5,173.75,172.75,196.75,177,165.5,200.25,203.25,194,168.5,170.75,183.25,178.25,163,175.25,158,177.25,179,191,187.5,206.5,185.25,160.25,151.5,161,167,177.5,152.25,192.25,165.25,171.75,171.25,197,157,168.25,186,166.75,187.75,168.25,212.75,176.75,173.25,167,159.75,188.15,156,208.5,206.5,143.75,223,152.25,241.75,146,156.75,200.25,171.5,205.75,182.5,136.5,177.25,151.25,196,184.25,140,218.75,217,166.25,224.75,228.25,172.75,152.25,125.75,177.25,176.25,226.75,145.25,151,241.25,187.25,234.75,219.25,145.75,159.25,170.5,167.5,232.75,210.5,202.25,185,153,244.25,193.5,224.75,162.75,180,156.25,168,167.25,170.75,178.25,150,200.5,184,223,208.75,166,195,160.5,159.75,140.5,216.25,168.25,194.75,172.75,219,149.25,154.5,199.25,154.5,153.25,230,161.75,142.25,179.75,126.5,169.5,198.5,174.5,167.75,147.75,182.25,175.5,161.75,157.75,168.75,191.5,219.15,155.25,189.75,127.5,224.5,234.25,227.75,199.5,155.5,215.5,134.25,201,186.75,190.75,207.5],[67.75,72.25,66.25,72.25,71.25,74.75,69.75,72.5,74,73.5,74.5,76,69.5,71.25,69.5,66,71,71,67.75,73.5,68,69.75,68.25,70,67.75,71.5,67.5,67.5,64.75,69,73.75,71.25,71.25,71,73.5,65,70,68.25,72.25,67,68.75,29.5,70,71.5,68,73.25,67.5,71.25,68.5,66.75,72.25,69,67.75,73.5,67.5,72,68,69.5,70.75,65.75,73.25,68.5,70.25,67,70,67.5,70.75,71.5,69.25,71.5,71.5,68.75,73.75,64,65.75,67.5,69.5,68.5,70.25,69.25,67.75,67.25,72.75,70,69.25,67.5,67.25,65.75,72.5,73,70,69.5,70.5,71.75,74.5,77.75,73.25,66.5,68.25,72,73.5,72,71.25,73.75,69.25,68.5,73.5,74.25,75.5,69.25,68.5,70,70,70.25,71.75,69.25,72.75,72,74,72.25,74.5,71.5,68.75,66.75,66.5,67,68.75,67.75,73.25,69.75,71.5,70.5,73.25,66.75,69.5,69.75,70.75,74,71.25,75,71,69.5,67.75,72.25,77.5,70.75,72.75,69.75,72.5,70.25,69,74.5,72.25,67.25,73.5,75.25,69,72.25,68.75,71.5,72.25,73,68.75,70.5,72,73.75,68,72.25,69.5,69.5,67.75,65.5,71,71.5,71.75,69.25,67,71.5,69.25,74.5,74.25,67.25,69.75,74.25,71.5,74.25,72,72.5,68.25,69.25,76,70.5,74.75,72.75,68.25,69,71.5,72.75,67.5,70.25,69.25,71.5,74,69.75,73,65.5,72.5,70.25,70.75,68,74.5,71.75,70.75,73,64,69.75,70,71.75,69.25,70.5,72.25,67.5,67.25,68.75,66.75,68.25,74.25,69.5,68.5,65.75,71.75,71.5,67.25,67.5,67.5,72.25,69.5,69.5,65.75,65.75,68.25,72,72.75,68.5,69.25,70.5,67,69.75,66,70.5,70],[36.2,38.5,34,37.4,34.4,39,36.4,37.8,38.1,42.1,38.5,39.4,38.4,39.4,40.5,36.4,38.9,42.1,38,40,39.1,41.3,33.9,35.5,34.5,35.7,36.2,38.8,36.4,36.7,38.7,37.3,38.1,39.8,42.1,38.4,38.5,42.1,51.2,40.2,43.2,36.6,37.3,41.5,31.5,35.7,33.6,34.6,32.8,34,34.9,34.3,36.5,35.1,37.8,39.9,39.1,40.5,40.5,38.4,41.4,35.6,38,37.4,40.1,40.9,35.6,36.9,37.5,36.3,35.5,38.7,36.4,33.2,36.5,36,38.7,38.7,37.8,37.4,38.4,38.1,39.3,38.7,38.5,36.5,37.7,36.5,38,36.7,37.2,39.2,37.5,38,37.3,41.1,37.5,38.7,35.9,40,40.1,37,36.3,40.7,39.6,31.1,38.6,42,38.5,34.2,37.2,37.1,40.2,35.3,38,36.3,36.8,41,38.3,38,40.8,39.5,36.9,36.9,37.7,36.6,38.9,37.5,39.8,38.3,35.5,36.3,37.8,37.8,36.5,37.8,37,37.7,34.3,40.8,37.4,36.5,37.5,35.5,38,35.7,39.2,40.9,35.2,40.6,35.4,41.8,34.1,37.9,38.2,35.6,38.5,37,35.9,36.2,35,38.5,40.7,36,39.5,40.5,38.5,43.9,40.4,37.6,37,34,38.4,38.7,41.5,36,35.3,42.1,38,42.8,40,35.5,35.3,37.7,39.4,41.9,38.5,40.8,38,36.4,41.8,40.7,38.5,35.4,38.5,35.5,36.5,37.6,37.4,37.8,35.2,37.9,37.9,40.9,41.9,39.1,40.2,36,34.5,35.8,40.2,38.3,39,37.4,41.2,34.8,36.9,39.4,37.6,38.5,42.5,37.4,35.2,41.1,33.4,37.2,38.3,38.1,37.4,35.2,39.4,38,35.1,40.4,38.3,40.6,40.2,37.9,40.8,34.7,38.8,41.4,41.3,40.7,36.3,40.8,34.9,40.9,38.9,38.9,40.8],[93.1,93.6,95.8,101.8,97.3,104.5,105.1,99.6,100.9,99.6,101.5,103.6,102,104.1,101.3,99.1,101.9,107.6,106.8,106.2,103.3,111.4,86,86.7,90.2,89.6,88.6,97.4,93.5,97.4,100.5,93.5,93,111.7,117,118.5,106.5,105.6,136.2,114.8,128.3,106,113.3,106.6,85.1,96.6,88.2,89.8,92.3,83.4,90.2,89.2,89.7,93.3,87.6,107.6,100,111.5,115.4,104.8,112.3,102.9,107.6,105.3,105.3,103,90,95.4,89.3,94.4,97.6,88.5,93.6,87.7,93.4,91.6,91.6,102,96.4,102.7,97.7,97.1,103.1,101.8,101.4,98.9,97.5,104.3,97.3,96.7,99.7,101.9,97.2,106.6,99.6,113.2,99.1,99.4,95.1,107.5,106.5,99.1,96.7,103.5,104,93.1,105.2,110,110.1,97.8,96.3,108,99.7,93.5,100.7,97,96,99.2,95.4,101.8,104.3,99.2,99.3,94,98.9,101,98.7,95.9,103.9,96.2,97.8,94.6,103.6,100.4,98.4,104.6,92.9,97.8,98.3,104.7,98.6,99.5,102.7,92.1,96.6,92.7,102,110.9,92.3,114.1,92.9,108.3,88.5,94,101.1,92.1,105.6,98.5,88.7,101.1,94,103.8,98.9,89.2,111.4,107.5,99.1,108.2,114.9,99.1,92.2,90.8,100.5,98.2,115.3,96.8,92.6,119.2,102.7,109.5,108.5,95.5,92.3,98.9,89.5,117.5,107.4,109.2,103.4,91.4,115.2,104.9,106.7,92.2,101.6,97.8,92,94,103.7,102.7,91.1,107.2,100.8,121.6,105.6,100.6,102.7,99.8,92.9,91.2,115.6,98.3,103.7,98.7,119.8,92.8,93.3,106.8,93.9,99,119.9,94.2,92.7,106.9,88.8,101.7,105.3,104,98.6,99.6,103.4,100.2,94.9,97.2,104.7,104,117.6,95.8,106.4,93,119.6,119.7,115.8,118.3,97.4,113.7,89.2,108.5,111.1,108.3,112.4],[85.2,83,87.9,86.4,100,94.4,90.7,88.5,82.5,88.6,83.6,90.9,91.6,101.8,96.4,92.8,96.4,97.5,89.6,100.5,95.9,98.8,76.4,80,76.3,79.7,74.6,88.7,73.9,83.5,88.7,84.5,79.1,100.5,115.6,113.1,100.9,98.8,148.1,108.1,126.2,104.3,111.2,104.3,76,81.5,73.7,79.5,83.4,70.4,86.7,77.9,82,79.6,77.6,100,99.8,104.2,105.3,98.3,104.8,94.7,102.4,99.7,105.5,100.3,83.9,86.6,78.4,84.6,91.5,82.8,82.9,76,83.3,81.8,78.8,95,95.4,98.6,95.8,89,97.8,94.9,99.8,89.7,88.1,90.9,86,86.5,95.6,93.2,83.1,97.5,88.8,99.2,91.6,86.7,88.2,94,95,92,89.2,95.5,98.6,87.3,102.8,101.6,88.7,92.3,90.6,105,95,89.6,92.4,86.6,90,90,92.4,87.5,99.2,98.1,83.3,86.1,84.1,89.9,92.1,78,93.5,87,90.1,90.3,99.8,89.4,87.2,101.1,86.1,98.6,88.5,106.6,93.1,93,91,77.1,85.3,81.9,99.1,100.5,76.5,106.8,77.6,102.9,72.8,88.2,100.1,83.5,105,90.8,76.6,92.4,81.2,95.6,92.1,83.4,106,95.1,90.4,100.4,115.9,90.8,81.9,75,90.3,90.3,108.8,79.4,83.2,110.3,92.7,104.5,104.6,83.6,86.8,90.4,83.7,109.3,98.9,98,101.2,80.6,113.7,94.1,105.7,85.6,96.6,86,89.7,78,89.7,89.2,85.7,103.1,89.1,113.9,96.3,93.9,101.3,83.9,84.4,79.4,104,89.7,97.6,87.6,122.1,81.1,81.5,100,88.7,91.8,110.4,87.6,82.8,95.3,78.2,91.1,96.7,89.4,93,86.4,96.7,88.1,94.9,93.3,95.6,98.2,113.8,82.8,100.5,79.7,118,109,113.4,106.1,84.3,107.6,83.6,105,111.5,101.3,108.5],[94.5,98.7,99.2,101.2,101.9,107.8,100.3,97.1,99.9,104.1,98.2,107.7,103.9,108.6,100.1,99.2,105.2,107,102.4,109,104.9,104.8,94.6,93.4,95.8,96.5,85.3,94.7,88.5,98.7,99.8,100.6,94.5,108.3,116.1,113.8,106.2,104.8,147.7,102.5,125.6,115.5,114.1,106,88.2,97.2,88.5,92.7,90.4,87.2,98.3,91,89.1,91.6,88.6,99.6,102.5,105.8,97,99.6,103.1,100.8,99.4,99.7,108.3,104.2,93.9,91.8,96.1,94.3,98.5,95.5,96.3,88.6,93,94.8,94.3,98.3,99.3,100.2,97.1,96.9,99.6,95,96.2,96.2,96.9,93.8,99.3,98.3,102.2,100.6,95.4,100.6,101.4,107.5,102.4,96.2,92.8,103.7,101.7,98.3,98.3,101.6,99.5,96.6,103.6,100.7,102.1,100.6,99.3,103,98.6,99.8,97.5,92.6,99.7,96.4,104.3,101,104.1,101.4,97.5,95.2,94,100,98.5,93.2,99.5,97.8,95.8,99.1,103.2,92.3,98.4,102.1,95.6,100.6,98.3,107.7,101.6,99.3,98.9,93.9,102.5,95.3,110.1,106.2,92.1,113.9,93.5,114.4,91.1,95.2,105,98.3,106.4,102.5,89.8,99.3,91.5,105.1,103.5,89.6,108.8,104.5,95.6,106.8,111.9,98.1,92.8,89.2,98.7,99.9,114.4,89.2,96.4,113.9,101.9,109.9,109.8,91.6,96.1,95.5,98.1,108.8,104.1,101.8,103.1,92.3,112.4,102.7,111.8,96.5,100.6,96.2,101,99,94.2,99.2,96.9,105.5,102.6,107.1,102,100.1,101.7,91.8,94,89,109,99.1,104.2,96.1,112.8,96.3,94.4,105,94.5,96.2,105.5,95.6,91.9,98.2,87.5,97.1,106.6,98.4,97,90.1,100.7,97.8,100.2,94,93.7,101.1,111.8,94.5,100.5,87.6,114.3,109.1,109.8,101.6,94.4,110,88.8,104.5,101.7,97.8,107.1],[59,58.7,59.6,60.1,63.2,66,58.4,60,62.9,63.1,59.7,66.2,63.4,66,69,63.1,64.8,66.9,64.2,65.8,63.5,63.4,57.4,54.9,58.4,55,51.7,57.5,50.1,58.9,57.5,58.5,57.3,67.1,71.2,61.9,63.5,66,87.3,61.3,72.5,70.6,67.7,65,50,58.4,53.3,52.7,52,50.6,52.6,51.4,49.3,52.6,51.9,57.2,62.1,61.8,59.1,60.6,61.6,60.9,61,60.8,65,64.8,55,54.3,56,51.2,56.6,58.9,52.9,50.9,55.5,54.5,56.7,55,53.5,56.5,54.8,54.8,58.9,56,56.3,54.7,57.2,57.8,61,60.4,58.3,58.9,56.9,58.9,57.4,61.7,60.6,62.1,54.7,62.7,59,59.3,60,59.1,59.5,54.7,61.2,55.8,57.5,57.5,61.9,63.7,62.3,61.5,59.3,55.9,58.8,56.8,64.6,58.5,58.5,57.1,60.5,58.1,58.5,60.7,60.7,53.5,61.7,57.4,57,60.3,61.2,56.1,56,58.9,58.8,63.6,58.1,66.5,59.1,60.4,57.1,56.1,59.1,56.4,71.2,68.4,51.9,67.6,56.9,72.9,53.6,56.8,62.1,57.3,68.6,60.8,50.1,59.4,52.5,61.4,64,52.4,63.8,64.8,55.5,63.3,74.4,60.1,54.7,50,57.8,59.2,69.2,50.3,60,69.8,64.7,69.5,68.1,54.1,58,55.4,57.3,67.7,63.5,62.8,61.5,54.3,68.5,60.6,65.3,60.2,61.1,57.7,62.3,57.5,58.5,60.2,55.5,68.8,60.6,63.5,63.3,58.9,60.7,53,56,51.1,63.7,56.3,60,57.1,62.5,53.8,54.7,63.9,53.7,57.7,64.2,59.7,54.4,57.4,50.8,56.6,64,58.4,55.4,53,59.3,57.1,56.8,54.3,54.4,59.3,63.4,61.2,59.2,50.7,61.3,63.7,65.6,58.2,54.3,63.3,49.6,59.6,60.3,56,59.3],[37.3,37.3,38.9,37.3,42.2,42,38.3,39.4,38.3,41.7,39.7,39.2,38.3,41.5,39,38.7,40.8,40,38.7,40.6,38,40.6,35.3,36.2,35.5,36.7,34.7,36,34.5,35.3,38.7,38.8,36.2,44.2,43.3,38.3,39.9,41.5,49.1,41.1,39.6,42.5,40.9,40.2,34.7,38.2,34.5,37.5,35.8,34.4,37.2,34.9,33.7,37.6,34.9,38,39.6,39.8,38,37.7,40.9,38,39.4,40.1,41.2,40.2,36.1,35.4,37.4,37.4,38.6,37.6,37.5,35.4,35.2,37,39.7,38.3,37.5,39.3,38.2,38,39,36.5,36.6,37.8,37.7,39.5,38.4,39.9,38.2,39.7,38.3,40.5,39.6,42.3,39.4,39.3,37.3,39,39.4,38.4,38.4,39.8,36.1,39,39.3,38.7,40,36.8,38,40,38.1,37.8,38.1,36.3,38.4,38.8,41.1,39.2,39.3,40.5,38.7,36.5,36.6,36,36.8,35.8,39,36.9,38.7,38.5,38.1,35.6,36.9,37.9,36.1,39.2,38.4,42.5,39.6,38.2,36.7,36.1,37.6,36.5,43.5,40.8,35.7,42.7,35.9,43.5,36.8,37.4,40,37.8,40,38.5,34.8,39,36.6,40.6,37.3,35.6,42,41.3,34.2,41.7,40.6,39.1,36.2,34.8,37.3,37.7,42.4,34.8,38.1,42.6,39.5,43.1,42.8,36.2,39.4,38.9,39.7,41.3,39.8,41.3,40.4,36.3,45,38.6,43.3,38.9,38.4,38.6,38,40,39,39.2,35.7,38.3,39,40.3,39.8,37.6,39.4,36.2,38.2,35,40.3,38.8,40.9,38.1,36.9,36.5,39,39.2,36.2,38.1,42.7,40.2,35.2,37.1,33,38.5,42.6,37.4,38.8,35,38.6,38.9,35.9,35.7,37.1,40.3,41.1,39.1,38.1,33.4,42.1,42.4,46,38.8,37.5,44,34.8,40.8,37.3,41.6,42.2],[21.9,23.4,24,22.8,24,25.6,22.9,23.2,23.8,25,25.2,25.9,21.5,23.7,23.1,21.7,23.1,24.4,22.9,24,22.1,24.6,22.2,22.1,22.9,22.5,21.4,21,21.3,22.6,33.9,21.5,24.5,25.2,26.3,21.9,22.6,24.7,29.6,24.7,26.6,23.7,25,23,21,23.4,22.5,21.9,20.6,21.9,22.4,21,21.4,22.6,22.5,22,22.5,22.7,22.5,22.9,23.1,22.1,23.6,22.7,24.7,22.7,21.7,21.5,22.4,21.6,22.4,21.6,23.1,19.1,20.9,21.4,24.2,21.8,21.5,22.7,23.7,22,23,24.1,22,33.7,21.8,23.3,23.8,24.4,22.5,23.1,22.1,24.5,24.6,23.2,22.9,23.3,21.9,22.3,22.3,22.4,23.2,25.4,22,24.8,23.5,23.4,24.8,22.8,22.3,23.6,23.9,21.9,21.8,22.1,22.8,23.3,24.8,24.5,24.6,23.2,22.6,22.1,23.5,21.9,22.2,20.8,21.8,22.2,23.2,23,22.6,20.5,23,22.7,22.4,23.8,22.5,24.5,21.6,22,22.3,22.7,23.2,22,25.2,24.6,22,24.7,20.4,25.1,23.8,22.8,24.9,21.7,25.2,25,21.8,24.6,21,25,23.5,20.4,23.4,25.6,21.9,24.6,24,23.4,22.1,22,22.4,21.5,24,22.2,22,24.8,24.7,25.8,24.1,21.8,22.7,22.4,22.6,24.7,23.5,24.8,22.9,21.8,25.5,24.7,26,22.4,24.1,24,22.3,22.5,24.1,23.8,22,23.7,24,21.8,24.1,21.4,23.3,22.5,22.6,21.7,23.2,23,25.5,21.8,23.6,21.5,22.6,22.9,22,23.9,27,23.4,22.5,21.8,19.7,22.6,23.4,22.5,23.2,21.3,22.8,23.6,21,21,22.7,23,22.3,22.3,24,20.1,23.4,24.6,25.4,24.1,22.6,22.6,21.5,23.2,21.5,22.7,24.6],[32,30.5,28.8,32.4,32.2,35.7,31.9,30.5,35.9,35.6,32.8,37.2,32.5,36.9,36.1,31.1,36.2,38.2,37.2,37.1,32.5,33,27.9,29.8,31.1,29.9,28.7,29.2,30.5,30.1,32.5,30.1,29,37.5,37.3,32,35.1,33.2,45,34.1,36.4,33.6,36.7,35.8,26.1,29.7,27.9,28.8,28.8,26.8,26,26.7,29.6,38.5,27.7,35.9,33.1,37.7,31.6,34.5,36.2,32.5,32.7,33.6,35.3,34.8,29.6,32.8,32.6,27.3,31.5,30.3,29.7,29.3,29.4,29.3,30.2,30.8,31.4,30.3,29.4,29.9,34.3,31.2,29.7,32.4,32.6,29.2,30.2,28.8,29.1,31.4,30.1,33.3,30.3,32.9,31.6,30.6,31.6,35.3,32.2,27.9,31,31,30.1,31,30.5,35.1,35.1,32.1,33.3,33.5,35.3,30.7,31.8,29.8,29.9,33.4,33.6,32.1,33.9,33,34.4,30.6,34.4,35.6,33.8,33.9,33.3,31.6,27.5,31.2,33.5,33.6,34,30.9,32.7,34.3,31.7,35.5,30.8,32,31.6,30.5,31.8,33.5,36.1,33.3,25.8,36,31.6,38.5,27.8,30.6,33.7,32.2,35.2,31.6,27,30.1,27,31.3,33.5,28.3,34,36.4,30.2,37.2,36.1,32.5,30.4,24.8,31,32.4,35.4,31,31.5,34.4,34.8,39.1,35.6,31.4,30,30.5,32.9,37.2,36.4,36.6,33.4,29.6,37.1,34,33.7,31.7,32.9,31.2,30.8,30.6,33.8,31.7,29.4,32.1,32.9,34.8,37.3,33.1,36.7,31.4,29,30.9,36.8,29.5,32.7,28.6,34.7,31.3,27.5,35.7,28.5,31.4,38.4,27.9,29.4,34.1,25.3,33.4,33.2,34.6,32.4,31.7,31.8,30.9,27.8,31.3,30.3,32.6,35.1,29.8,35.9,28.5,34.9,35.6,35.3,32.1,29.2,37.5,25.6,35.2,31.3,30.5,33.7],[27.4,28.9,25.2,29.4,27.7,30.6,27.8,29,31.1,30,29.4,30.2,28.6,31.6,30.5,26.4,30.8,31.6,30.5,30.1,30.3,32.8,25.9,26.7,28,28.2,27,26.6,27.9,26.7,27.7,26.4,30,31.5,31.7,29.8,30.6,30.5,29,31,32.7,28.7,29.8,31.5,23.1,27.4,26.2,26.8,25.5,25.8,25.8,26.1,26,27.4,27.5,30.2,28.3,30.9,28.8,29.6,31.8,29.8,29.9,29,31.1,30.1,27.4,27.4,28.1,27.1,27.3,27.3,27.3,25.7,27,27,29.2,25.7,26.8,28.7,27.2,25.2,29.6,27.3,26.3,27.7,28,28.4,29.3,29.6,27.7,28.4,28.2,29.6,27.9,30.8,30.1,27.8,27.5,30.9,31,26.2,29.2,30.3,27.2,29.4,28.5,29.6,30.7,26,28.2,27.8,31.1,27.6,27.3,26.3,28,29.8,29.5,28.6,31.2,29.6,28,27.5,29.2,30.2,30.3,28.2,29.6,27.8,26.5,28.4,28.6,29.3,29.8,28.8,28.3,28.4,27.4,29.8,27.9,28.5,27.5,27.2,29.7,28.3,30.3,29.7,25.2,30.4,29,33.8,26.3,28.3,29.2,27.7,30.7,28,34.9,28.2,26.3,29.2,30.6,26.2,31.2,33.7,28.7,33.1,31.8,29.8,27.4,25.9,28.7,28.4,21,26.9,26.6,29.5,30.3,32.5,29,28.3,26.4,28.9,29.3,31.8,30.4,32.4,29.2,27.3,31.2,30.1,29.9,27.1,29.8,27.3,27.8,30,28.8,28.4,26.6,28.9,29.2,30.7,23.1,29.5,31.6,27.5,26.2,28.8,31,27.9,30,26.7,29.1,26.3,25.9,30.4,25.7,29.9,32,27,26.8,31.1,22,29.3,30,30.1,29.7,27.3,29.1,29.6,26.1,28.7,26.3,28.5,29.6,28.9,30.5,24.8,30.1,30.7,29.8,29.3,27.3,32.6,25.7,28.6,27.2,29.4,30],[17.1,18.2,16.6,18.2,17.7,18.8,17.7,18.8,18.2,19.2,18.5,19,17.7,18.8,18.2,16.9,17.3,19.3,18.5,18.2,18.4,19.9,16.7,17.1,17.6,17.7,16.5,17,17.2,17.6,18.4,17.9,18.8,18.7,19.7,17,19,19.4,21.4,18.3,21.4,17.4,18.4,18.8,16.1,18.3,17.3,17.9,16.3,16.8,17.3,17.2,16.9,18.5,18.5,18.9,18.5,19.2,18.2,18.5,20.2,18.3,19.1,18.8,18.4,18.7,17.4,18.7,18.1,17.3,18.6,18.3,18.2,16.9,16.8,18.3,18.1,18.8,18.3,19,19,17.7,19,19.2,18,18.2,18.8,18.1,18.8,18.7,17.7,18.8,18.4,19.1,17.8,20.4,18.5,18.2,18.2,18.3,18.6,17,18.4,19.7,17.7,18.8,18.1,19.1,19.2,17.3,18.1,17.4,19.8,17.4,17.5,17.3,18.1,19.5,18.5,18,19.5,18.4,17.6,17.6,18,17.6,17.2,17.4,18.1,17.7,17.6,17.1,17.9,17.3,18.1,17.6,17.1,17.7,17.6,18.7,16.6,17.8,17.9,18.2,18.3,17.3,18.7,18.4,16.9,18.4,17.8,19.6,17.4,17.9,19.4,17.7,19.1,18.6,16.9,18.2,16.5,19.1,19.7,16.5,18.5,19.4,17.7,19.8,18.8,17.4,17.7,16.9,17.7,17.8,20.1,16.9,16.7,18.4,18.1,19.9,19,17.2,17.4,17.7,18.2,20,19.1,18.8,18.5,17.9,19.9,18.7,18.5,17.1,18.8,17.4,16.9,18.5,18.8,18.6,17.4,18.7,18.4,17.4,19.4,17.3,18.4,17.7,17.6,17.4,18.9,18.6,19,18,18.4,17.8,18.6,19.2,17.1,18.9,19.6,17.8,17,19.2,15.8,18.8,18.4,18.8,19,16.9,19,18,17.6,18.3,18.3,19,18.5,18.3,19.1,16.5,19.4,19.5,19.5,18.5,18.5,18.8,18.5,20.1,18,19.8,20.9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>pbf1<\/th>\n      <th>age<\/th>\n      <th>weight<\/th>\n      <th>height<\/th>\n      <th>neck<\/th>\n      <th>chest<\/th>\n      <th>abdomen<\/th>\n      <th>hip<\/th>\n      <th>thigh<\/th>\n      <th>knee<\/th>\n      <th>ankle<\/th>\n      <th>bicep<\/th>\n      <th>forearm<\/th>\n      <th>wrist<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="xlsx-files" class="section level3">
<h3>
<span class="header-section-number">21.9.2</span> XLSX files<a class="anchor" aria-label="anchor" href="#xlsx-files"><i class="fas fa-link"></i></a>
</h3>
<p>You may not be able to view the “Raw” data for some files (e.g. .xlsx, .rds, .nwk, .shp)</p>
<ol style="list-style-type: decimal">
<li>Go to the Github repo, locate the file of interest, and click on it<br>
</li>
<li>Click the “Download” button, as shown below<br>
</li>
<li>Save the file on your computer, and import it into R</li>
</ol>
<div class="inline-figure"><img src="inst/figures/download_xlsx.png" width="100%" style="display: block; margin: auto auto auto 0;"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="manual-data-entry" class="section level2">
<h2>
<span class="header-section-number">21.10</span> Manual data entry<a class="anchor" aria-label="anchor" href="#manual-data-entry"><i class="fas fa-link"></i></a>
</h2>
<div id="entry-by-rows" class="section level3">
<h3>
<span class="header-section-number">21.10.1</span> Entry by rows<a class="anchor" aria-label="anchor" href="#entry-by-rows"><i class="fas fa-link"></i></a>
</h3>
<p>Use the <code>tribble</code> function from the <strong>tibble</strong> package from the tidyverse (<a href="https://tibble.tidyverse.org/reference/tribble.html">online tibble reference</a>).</p>
<p>Note how column headers start with a <em>tilde</em> (<code>~</code>). Also note that each column must contain only one class of data (character, numeric, etc.). You can use tabs, spacing, and new rows to make the data entry more intuitive and readable. Spaces do not matter between values, but each row is represented by a new line of code. For example:</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the dataset manually by row</span>
<span class="va">manual_entry_rows</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">colA</span>, <span class="op">~</span><span class="va">colB</span>,
  <span class="st">"a"</span>,   <span class="fl">1</span>,
  <span class="st">"b"</span>,   <span class="fl">2</span>,
  <span class="st">"c"</span>,   <span class="fl">3</span>
  <span class="op">)</span></code></pre></div>
<p>And now we display the new dataset:</p>
<div id="htmlwidget-e32a60ff0a0fece1cfa4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e32a60ff0a0fece1cfa4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["a","b","c"],[1,2,3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>colA<\/th>\n      <th>colB<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="entry-by-columns" class="section level3">
<h3>
<span class="header-section-number">21.10.2</span> Entry by columns<a class="anchor" aria-label="anchor" href="#entry-by-columns"><i class="fas fa-link"></i></a>
</h3>
<p>Since a data frame consists of vectors (vertical columns), the <strong>base</strong> approach to manual dataframe creation in R expects you to define each column and then bind them together. This can be counter-intuitive in epidemiology, as we usually think about our data in rows (as above).</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define each vector (vertical column) separately, each with its own name</span>
<span class="va">PatientID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">235</span>, <span class="fl">452</span>, <span class="fl">778</span>, <span class="fl">111</span><span class="op">)</span>
<span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span><span class="op">)</span>
<span class="va">Death</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> All vectors must be the same length (same number of values).</span></p>
<p>The vectors can then be bound together using the function <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>:</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># combine the columns into a data frame, by referencing the vector names</span>
<span class="va">manual_entry_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">PatientID</span>, <span class="va">Treatment</span>, <span class="va">Death</span><span class="op">)</span></code></pre></div>
<p>And now we display the new dataset:</p>
<div id="htmlwidget-bb96f095e84a1c9b5f4b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bb96f095e84a1c9b5f4b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],[235,452,778,111],["Yes","No","Yes","Yes"],[1,0,1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PatientID<\/th>\n      <th>Treatment<\/th>\n      <th>Death<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pasting-from-clipboard" class="section level3">
<h3>
<span class="header-section-number">21.10.3</span> Pasting from clipboard<a class="anchor" aria-label="anchor" href="#pasting-from-clipboard"><i class="fas fa-link"></i></a>
</h3>
<p>If you copy data from elsewhere and have it on your clipboard, you can try using the <a href="https://www.r-pkg.org/pkg/datapasta">datapasta</a> R package which allows you to import as a data frame as shown in Figure <a href="import.html#fig:datapasta">21.3</a>:</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:datapasta"></span>
<img src="inst/gifs/tribble_paste.gif" alt="Copying data to your clipboard and pasting as a data frame in R." width="100%"><p class="caption">
Figure 21.3: Copying data to your clipboard and pasting as a data frame in R.
</p>
</div>
<!-- ======================================================= -->
</div>
</div>
<div id="export" class="section level2">
<h2>
<span class="header-section-number">21.11</span> Export<a class="anchor" aria-label="anchor" href="#export"><i class="fas fa-link"></i></a>
</h2>
<div id="with-rio-package" class="section level3">
<h3>
<span class="header-section-number">21.11.1</span> With <strong>rio</strong> package<a class="anchor" aria-label="anchor" href="#with-rio-package"><i class="fas fa-link"></i></a>
</h3>
<p>With <strong>rio</strong>, you can use the <code><a href="https://rdrr.io/pkg/rio/man/export.html">rio::export()</a></code> function in a very similar way to <code><a href="https://rdrr.io/pkg/rio/man/import.html">rio::import()</a></code>. First give the name of the R object you want to save (e.g. <code>linelist</code>) and then in quotes put the file path where you want to save the file, including the desired file name and file extension. For example:</p>
<p>This saves the data frame <code>linelist</code> as an Excel workbook to the working directory (R Project root folder):</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="st">"my_linelist.xlsx"</span><span class="op">)</span> <span class="co"># will save to working directory</span></code></pre></div>
<p>You could save the same data frame as a csv file by changing the extension. For example, we also save it to a file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>:</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"my_linelist.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="import_rds" class="section level2">
<h2>
<span class="header-section-number">21.12</span> RDS files<a class="anchor" aria-label="anchor" href="#import_rds"><i class="fas fa-link"></i></a>
</h2>
<p>Along with .csv, .xlsx, etc, you can also export/save R data frames as .rds files. This is a file format specific to R, and is very useful if you know you will work with the exported data again in R.</p>
<p>The classes of columns are stored, so you don’t have do to cleaning again when it is imported (with an Excel or even a CSV file this can be a headache!). It is also a smaller file, which is useful for export and import if your dataset is large.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"my_linelist.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="import_rdata" class="section level2">
<h2>
<span class="header-section-number">21.13</span> Rdata files and lists<a class="anchor" aria-label="anchor" href="#import_rdata"><i class="fas fa-link"></i></a>
</h2>
<p><code>.Rdata</code> files can store multiple R objects - for example multiple data frames, model results, lists, etc. This can be very useful to consolidate or share a lot of your data for a given project.</p>
<p>In the below example, multiple R objects are stored within the exported file “my_objects.Rdata”:</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">my_list</span>, <span class="va">my_dataframe</span>, <span class="va">my_vector</span>, <span class="st">"my_objects.Rdata"</span><span class="op">)</span></code></pre></div>
<p>Note: if you are trying to <em>import</em> a list, use <code><a href="https://rdrr.io/pkg/rio/man/import_list.html">rio::import_list()</a></code> to import it with the complete original structure and contents.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import_list.html">import_list</a></span><span class="op">(</span><span class="st">"my_list.Rdata"</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="saving-plots" class="section level2">
<h2>
<span class="header-section-number">21.14</span> Saving plots<a class="anchor" aria-label="anchor" href="#saving-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Instructions on how to save plots, such as those created by <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, are discussed in depth in the [ggplot basics] page.</p>
<p>In brief, run <code>ggsave("my_plot_filepath_and_name.png")</code> after printing your plot. You can either provide a saved plot object to the <code>plot =</code> argument, or only specify the destination file path (with file extension) to save the most recently-displayed plot. You can also control the <code>width =</code>, <code>height =</code>, <code>units =</code>, and <code>dpi =</code>.</p>
<p>How to save a network graph, such as a transmission tree, is addressed in the page on [Transmission chains].</p>
<!-- ======================================================= -->
</div>
<div id="resources" class="section level2">
<h2>
<span class="header-section-number">21.15</span> Resources<a class="anchor" aria-label="anchor" href="#resources"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://cran.r-project.org/doc/manuals/r-release/R-data.html">R Data Import/Export Manual</a><br><a href="https://r4ds.had.co.nz/data-import.html#data-import">R 4 Data Science chapter on data import</a><br><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave() documentation</a></p>
<p>Below is a table, taken from the <strong>rio</strong> online <a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html">vignette</a>. For each type of data it shows: the expected file extension, the package <strong>rio</strong> uses to import or export the data, and whether this functionality is included in the default installed version of <strong>rio</strong>.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Format</th>
<th>Typical Extension</th>
<th>Import Package</th>
<th>Export Package</th>
<th>Installed by Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Comma-separated data</td>
<td>.csv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Pipe-separated data</td>
<td>.psv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Tab-separated data</td>
<td>.tsv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>SAS</td>
<td>.sas7bdat</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>SPSS</td>
<td>.sav</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Stata</td>
<td>.dta</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>SAS</td>
<td>XPORT</td>
<td>.xpt</td>
<td>haven</td>
<td>haven</td>
</tr>
<tr class="even">
<td>SPSS Portable</td>
<td>.por</td>
<td>haven</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Excel</td>
<td>.xls</td>
<td>readxl</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Excel</td>
<td>.xlsx</td>
<td>readxl</td>
<td>openxlsx</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>R syntax</td>
<td>.R</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Saved R objects</td>
<td>.RData, .rda</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Serialized R objects</td>
<td>.rds</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Epiinfo</td>
<td>.rec</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Minitab</td>
<td>.mtp</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Systat</td>
<td>.syd</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>“XBASE”</td>
<td>database files</td>
<td>.dbf</td>
<td>foreign</td>
<td>foreign</td>
</tr>
<tr class="even">
<td>Weka Attribute-Relation File Format</td>
<td>.arff</td>
<td>foreign</td>
<td>foreign</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Data Interchange Format</td>
<td>.dif</td>
<td>utils</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Fortran data</td>
<td>no recognized extension</td>
<td>utils</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Fixed-width format data</td>
<td>.fwf</td>
<td>utils</td>
<td>utils</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>gzip comma-separated data</td>
<td>.csv.gz</td>
<td>utils</td>
<td>utils</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>CSVY (CSV + YAML metadata header)</td>
<td>.csvy</td>
<td>csvy</td>
<td>csvy</td>
<td>No</td>
</tr>
<tr class="even">
<td>EViews</td>
<td>.wf1</td>
<td>hexView</td>
<td></td>
<td>No</td>
</tr>
<tr class="odd">
<td>Feather R/Python interchange format</td>
<td>.feather</td>
<td>feather</td>
<td>feather</td>
<td>No</td>
</tr>
<tr class="even">
<td>Fast Storage</td>
<td>.fst</td>
<td>fst</td>
<td>fst</td>
<td>No</td>
</tr>
<tr class="odd">
<td>JSON</td>
<td>.json</td>
<td>jsonlite</td>
<td>jsonlite</td>
<td>No</td>
</tr>
<tr class="even">
<td>Matlab</td>
<td>.mat</td>
<td>rmatio</td>
<td>rmatio</td>
<td>No</td>
</tr>
<tr class="odd">
<td>OpenDocument Spreadsheet</td>
<td>.ods</td>
<td>readODS</td>
<td>readODS</td>
<td>No</td>
</tr>
<tr class="even">
<td>HTML Tables</td>
<td>.html</td>
<td>xml2</td>
<td>xml2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Shallow XML documents</td>
<td>.xml</td>
<td>xml2</td>
<td>xml2</td>
<td>No</td>
</tr>
<tr class="even">
<td>YAML</td>
<td>.yml</td>
<td>yaml</td>
<td>yaml</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Clipboard default is tsv</td>
<td></td>
<td>clipr</td>
<td>clipr</td>
<td>No</td>
</tr>
</tbody>
</table></div>
<!-- ======================================================= --><!-- ======================================================= --><!-- ======================================================= -->
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="packages.html"><span class="header-section-number">20</span> Packages</a></div>
<div class="next"><a href="transition-to-r-from-excel-stata-sas.html"><span class="header-section-number">22</span> Transition to R from Excel, Stata, SAS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#import"><span class="header-section-number">21</span> Data Import and Export</a></li>
<li><a class="nav-link" href="#overview-1"><span class="header-section-number">21.1</span> Overview</a></li>
<li><a class="nav-link" href="#the-rio-package"><span class="header-section-number">21.2</span> The rio package</a></li>
<li><a class="nav-link" href="#here"><span class="header-section-number">21.3</span> The here package</a></li>
<li>
<a class="nav-link" href="#file-paths"><span class="header-section-number">21.4</span> File paths</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#relative-file-paths"><span class="header-section-number">21.4.1</span> “Relative” file paths</a></li>
<li><a class="nav-link" href="#absolute-file-paths"><span class="header-section-number">21.4.2</span> “Absolute” file paths</a></li>
</ul>
</li>
<li><a class="nav-link" href="#import-data-from-excel"><span class="header-section-number">21.5</span> Import data from Excel</a></li>
<li><a class="nav-link" href="#import_missing"><span class="header-section-number">21.6</span> Missing values</a></li>
<li><a class="nav-link" href="#skip-rows"><span class="header-section-number">21.7</span> Skip rows</a></li>
<li><a class="nav-link" href="#import-from-google-sheets"><span class="header-section-number">21.8</span> Import from Google sheets</a></li>
<li>
<a class="nav-link" href="#import_github"><span class="header-section-number">21.9</span> Import from Github</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#csv-files"><span class="header-section-number">21.9.1</span> CSV files</a></li>
<li><a class="nav-link" href="#xlsx-files"><span class="header-section-number">21.9.2</span> XLSX files</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#manual-data-entry"><span class="header-section-number">21.10</span> Manual data entry</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#entry-by-rows"><span class="header-section-number">21.10.1</span> Entry by rows</a></li>
<li><a class="nav-link" href="#entry-by-columns"><span class="header-section-number">21.10.2</span> Entry by columns</a></li>
<li><a class="nav-link" href="#pasting-from-clipboard"><span class="header-section-number">21.10.3</span> Pasting from clipboard</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#export"><span class="header-section-number">21.11</span> Export</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#with-rio-package"><span class="header-section-number">21.11.1</span> With rio package</a></li></ul>
</li>
<li><a class="nav-link" href="#import_rds"><span class="header-section-number">21.12</span> RDS files</a></li>
<li><a class="nav-link" href="#import_rdata"><span class="header-section-number">21.13</span> Rdata files and lists</a></li>
<li><a class="nav-link" href="#saving-plots"><span class="header-section-number">21.14</span> Saving plots</a></li>
<li><a class="nav-link" href="#resources"><span class="header-section-number">21.15</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EPIB607</strong>" was written by Sahir Bhatnagar and James A Hanley. It was last built on 2021-12-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
