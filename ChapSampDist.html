<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 The Sampling Distribution | EPIB607</title>
<meta name="author" content="Sahir Bhatnagar and James A Hanley">
<meta name="description" content="10.1 Student Learning Objective In this section we integrate the concept of data that is extracted from a sample with the concept of a random variable. The new element that connects between these...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 10 The Sampling Distribution | EPIB607">
<meta property="og:type" content="book">
<meta property="og:url" content="https://sahirbhatnagar.com/EPIB607/ChapSampDist.html">
<meta property="og:description" content="10.1 Student Learning Objective In this section we integrate the concept of data that is extracted from a sample with the concept of a random variable. The new element that connects between these...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 The Sampling Distribution | EPIB607">
<meta name="twitter:description" content="10.1 Student Learning Objective In this section we integrate the concept of data that is extracted from a sample with the concept of a random variable. The new element that connects between these...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="templates/bs4_style.css">
<link rel="stylesheet" href="templates/ims-style.css">
<link rel="stylesheet" href="templates/corrections.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EPIB607</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="schedule.html">Schedule</a></li>
<li><a class="" href="syllabus.html">Syllabus</a></li>
<li class="book-part">Descriptive Statistics</li>
<li><a class="" href="introdata.html"><span class="header-section-number">1</span> Introduction to Data</a></li>
<li><a class="" href="aesthetic-mapping.html"><span class="header-section-number">2</span> Visualizing data: Mapping data onto aesthetics</a></li>
<li><a class="" href="coordinate-systems-axes.html"><span class="header-section-number">3</span> Coordinate systems and axes</a></li>
<li><a class="" href="ggplot2-package-for-plots.html"><span class="header-section-number">4</span> ggplot2 package for plots</a></li>
<li><a class="" href="color-basics.html"><span class="header-section-number">5</span> Color scales</a></li>
<li class="book-part">Sampling Distributions</li>
<li><a class="" href="paras.html"><span class="header-section-number">6</span> Statistical Parameters</a></li>
<li><a class="" href="ChapProbability.html"><span class="header-section-number">7</span> Probability</a></li>
<li><a class="" href="randomVariables.html"><span class="header-section-number">8</span> Random Variables</a></li>
<li><a class="" href="ChapNormal.html"><span class="header-section-number">9</span> The Normal Random Variable</a></li>
<li><a class="active" href="ChapSampDist.html"><span class="header-section-number">10</span> The Sampling Distribution</a></li>
<li><a class="" href="CI.html"><span class="header-section-number">11</span> Parameter Intervals</a></li>
<li><a class="" href="foundations-bootstrapping.html"><span class="header-section-number">12</span> Confidence intervals with bootstrapping</a></li>
<li class="book-part">One Sample Inference</li>
<li><a class="" href="inference-one-mean.html"><span class="header-section-number">13</span> Inference for a single mean</a></li>
<li><a class="" href="ChapBinom.html"><span class="header-section-number">14</span> Binomial Random Variable</a></li>
<li><a class="" href="inference-one-prop.html"><span class="header-section-number">15</span> Inference for a single proportion</a></li>
<li class="book-part">Computing</li>
<li><a class="" href="install.html"><span class="header-section-number">16</span> Installing R and RStudio</a></li>
<li><a class="" href="basics.html"><span class="header-section-number">17</span> Basics of R and Rstudio</a></li>
<li><a class="" href="projects.html"><span class="header-section-number">18</span> RStudio Projects</a></li>
<li><a class="" href="functionsHOP.html"><span class="header-section-number">19</span> Functions</a></li>
<li><a class="" href="packages.html"><span class="header-section-number">20</span> Packages</a></li>
<li><a class="" href="import.html"><span class="header-section-number">21</span> Data Import and Export</a></li>
<li><a class="" href="transition-to-r-from-excel-stata-sas.html"><span class="header-section-number">22</span> Transition to R from Excel, Stata, SAS</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ChapSampDist" class="section level1">
<h1>
<span class="header-section-number">10</span> The Sampling Distribution<a class="anchor" aria-label="anchor" href="#ChapSampDist"><i class="fas fa-link"></i></a>
</h1>
<div id="student-learning-objective-2" class="section level2">
<h2>
<span class="header-section-number">10.1</span> Student Learning Objective<a class="anchor" aria-label="anchor" href="#student-learning-objective-2"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we integrate the concept of <em>data</em> that is extracted
from a sample with the concept of a <em>random variable</em>. The new element
that connects between these two concepts is the notion of <em>sampling
distribution</em>. The data we observe results from the specific sample that
was selected. The sampling distribution, in a similar way to random
variables, corresponds to all samples that could have been selected.
(Or, stated in a different tense, to the sample that will be selected
prior to the selection itself.) Summaries of the distribution of the
data, such as the sample mean and the sample standard deviation, become
random variables when considered in the context of the sampling
distribution. In this section we investigate the sampling distribution
of such data summaries. In particular, it is demonstrated that (for
large samples) the sampling distribution of the sample average may be
approximated by the Normal distribution. The mathematical theorem that
proves this approximation is called the <em>Central Limit Theory</em>. By the
end of this chapter, the student should be able to:</p>
<ul>
<li><p>Comprehend the notion of sampling distribution and simulate the
sampling distribution of the sample average.</p></li>
<li><p>Relate the expectation and standard deviation of a measurement to
the expectation and standard deviation of the sample average.</p></li>
<li><p>Apply the Central Limit Theorem to the sample averages.</p></li>
</ul>
</div>
<div id="the-sampling-distribution" class="section level2">
<h2>
<span class="header-section-number">10.2</span> The Sampling Distribution<a class="anchor" aria-label="anchor" href="#the-sampling-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>In Chapter <a href="ChapProbability.html#ChapProbability">7</a> the concept of a random variable was
introduced. As part of the introduction we used an example that involved
the selection of a random person from the population and the measuring
of his/her height. Prior to the action of selection, the height of that
person is a <em>random variable</em>. It has the potential of obtaining any of
the heights that are present in the population, which is the <em>sample
space</em> of this example, with a distribution that reflects the relative
frequencies of each of the heights in the population: the
<em>probabilities</em> of the values. After the selection of the person and the
measuring of the height we get a particular value. This is the <em>observed
value</em> and is no longer a random variable. In this section we extend the
concept of a random variable and define the concept of <em>a random
sample</em>.</p>
<div id="a-random-sample" class="section level3">
<h3>
<span class="header-section-number">10.2.1</span> A Random Sample<a class="anchor" aria-label="anchor" href="#a-random-sample"><i class="fas fa-link"></i></a>
</h3>
<p>The relation between the random sample and the data is similar to the
relation between a random variable and the observed value. The data is
the observed values of a sample taken from a population. The content of
the data is known. The random sample, similarly to a random variable, is
the data that <em>will</em> be selected when taking a sample, prior to the
selection itself. The content of the random sample is unknown, since the
sample has not yet been taken. Still, just like for the case of the
random variable, one is able to say what the possible evaluations of the
sample may be and, depending on the mechanism of selecting the sample,
what are the probabilities of the different potential evaluations. The
collection of all possible evaluations of the sample is the <em>sample
space of the random sample</em> and the probabilities of the different
evaluations produce the <em>distribution</em> of the random sample.</p>
<p>(Alternatively, if one prefers to speak in past tense, one can define
the sample space of a random sample to be the evaluations of the sample
that could have taken place, with the distribution of the random sample
being the probabilities of these evaluations.)</p>
<p>A <em>statistic</em> is a function of the data. Example of statistics are the
average of the data, the sample variance and standard deviation, the
median of the data, etc. In each case a given formula is applied to the
data. In each type of statistic a different formula is applied.</p>
<p>The same formula that is applied to the observed data may, in principle,
be applied to random samples. Hence, for example, one may talk of the
sample average, which is the average of the elements in the data. The
average, considered in the context of the observed data, is a number and
its value is known. However, if we think of the average in the context
of a random sample then it becomes a random variable. Prior to the
selection of the actual sample we do not know what values it will
include. Hence, we cannot tell what the outcome of the average of the
values will be. However, due to the identification of all possible
evaluations that the sample can possess we may say in advance what is
the collection of values the sample average can have. This is the sample
space of the sample average. Moreover, from the sampling distribution of
the random sample one may identify the probability of each value of the
sample average, thus obtaining the <em>sampling distribution</em> of the sample
average.</p>
<p>The same line of argumentation applies to any statistic. Computed in the
context of the observed data, the statistic is a known number that may,
for example, be used to characterize the variation in the data. When
thinking of a statistic in the context of a random sample it becomes a
random variable. The distribution of the statistic is called the
sampling distribution of the statistic. Consequently, we may talk of the
sampling distribution of the median, the sample distribution of the
sample variance, etc.</p>
<p>Random variables are also applied as models for uncertainty in future
measurements in more abstract settings that need not involve a specific
population. Specifically, we introduced the Binomial and Poisson random
variables for settings that involve counting and the Uniform,
Exponential, and Normal random variables for settings where the
measurement is continuous.</p>
<p>The notion of a sampling distribution may be extended to a situation
where one is taking several measurements, each measurement taken
independently of the others. As a result one obtains a <em>sequence</em> of
measurements. We use the term “sample” to denote this sequence. The
distribution of this sequence is also called the sampling distribution.
If all the measurements in the sequence are Binomial then we call it a
<em>Binomial sample</em>. If all the measurements are Exponential we call it an
<em>Exponential sample</em> and so forth.</p>
<p>Again, one may apply a formula (such as the average) to the content of
the random sequence and produce a random variable. The term <em>sampling
distribution</em> describes again the distribution that the random variable
produced by the formula inherits from the sample.</p>
<p>In the next subsection we examine an example of a sample taken from a
population. Subsequently, we discuss examples that involves a sequence
of measurements from a theoretical model.</p>
</div>
<div id="sampling-from-a-population-1" class="section level3">
<h3>
<span class="header-section-number">10.2.2</span> Sampling From a Population<a class="anchor" aria-label="anchor" href="#sampling-from-a-population-1"><i class="fas fa-link"></i></a>
</h3>
<p>Consider taking a sample from a population. Let us use again for the
illustration the <code>heights_population.csv</code> file that contains the population data and can
be obtained <a href="https://github.com/sahirbhatnagar/EPIB607/blob/master/inst/data/heights_sample.csv%3E">here</a> like we did in
Chapter <a href="ChapProbability.html#ChapProbability">7</a>. The data frame produced from the file
contains the sex and hight of the 100,000 members of some imaginary
population. Recall that in Chapter <a href="ChapProbability.html#ChapProbability">7</a> we applied the
function <code>sample</code> to randomly sample the height of a single subject
from the population. Let us apply the same function again, but this time
in order to sample the heights of 100 subjects:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heights_population</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"inst/data/heights_population.csv"</span><span class="op">)</span><span class="op">)</span>
<span class="va">heights_population</span> <span class="op">&lt;-</span> <span class="va">heights_population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span>
<span class="va">Y.samp</span> <span class="op">&lt;-</span> <span class="va">heights_population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">Y.samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 100</span>
<span class="co">#&gt; Columns: 3</span>
<span class="co">#&gt; $ id     &lt;int&gt; 3776094, 8205435, 2010906, 6929553, 9381841…</span>
<span class="co">#&gt; $ sex    &lt;fct&gt; MALE, MALE, FEMALE, FEMALE, MALE, FEMALE, F…</span>
<span class="co">#&gt; $ height &lt;int&gt; 177, 173, 163, 167, 174, 163, 160, 150, 167…</span></code></pre></div>
<p>Typically, a researcher does not get to examine the entire population.
Instead, measurements on a sample from the population are made. In
relation to the imaginary setting we simulate in the example, the
typical situation is that the research does not have the complete list
of potential measurement evaluations, i.e. the complete list of 100,000
heights, but only a sample of measurements, namely
the list of 100 rows that are stored in <code>Y.samp</code> and are presented
above. The role of statistics is to make inference on the parameters of
the unobserved population based on the information that is obtained from
the sample.</p>
<p>For example, we may be interested in estimating the mean value of the
heights in the population. A reasonable proposal is to use the sample
average to serve as an estimate:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="co">#&gt; [1] 168.32</span></code></pre></div>
<p>In our artificial example we can actually compute the true population
mean:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">heights_population</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="co">#&gt; [1] 170.035</span></code></pre></div>
<p>Hence, we may see that although the match between the estimated value
and the actual value is not perfect still they are close enough.</p>
<p>The actual estimate that we have obtained resulted from the specific
sample that was collected. Had we collected a different subset of 100
individuals we would have obtained different numerical value for the
estimate. Consequently, one may wonder: Was it pure luck that we got
such good estimates? How likely is it to get estimates that are close to
the target parameter?</p>
<p>Notice that in realistic settings we do not know the actual value of the
target population parameters. Nonetheless, we would still want to have
at least a probabilistic assessment of the distance between our
estimates and the parameters they try to estimate. The sampling
distribution is the vehicle that may enable us to address these
questions.</p>
<p>In order to illustrate the concept of the sampling distribution let us
select another sample and compute its average:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y.samp</span> <span class="op">&lt;-</span> <span class="va">heights_population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>and do it once more:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y.samp</span> <span class="op">&lt;-</span> <span class="va">heights_population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="co">#&gt; [1] 171.04</span></code></pre></div>
<p>In each case we got a different value for the sample average. In the
first of the last two iterations the result was more than 1 centimeter
away from the population average, which is equal to 170.035, and in the
second it was within the range of 1 centimeter. Can we say, prior to
taking the sample, what is the probability of falling within 1
centimeter of the population mean?</p>
<p>Chapter <a href="ChapProbability.html#ChapProbability">7</a> discussed the random variable that emerges by
randomly sampling a single number from the population presented by the
sequence <code>heights_population$height</code>. The distribution of the random variable
resulted from the assignment of the probability 1/100,000 to each one of
the 100,000 possible outcomes. The same principle applies when we
randomly sample 100 individuals. Each possible outcome is a collection
of 100 numbers and each collection is assigned equal probability. The
resulting distribution is called <em>the sampling distribution</em>.</p>
<p>The distribution of the average of the sample emerges from this
distribution: With each sample one may associate the average of that
sample. The probability assigned to that average outcome is the
probability of the sample. Hence, one may assess the probability of
falling within 1 centimeter of the population mean using the sampling
distribution. Each sample produces an average that either falls within
the given range or not. The probability of the sample average falling
within the given range is the proportion of samples for which this event
happens among the entire collection of samples.</p>
<p>However, we face a technical difficulty when we attempt to assess the
sampling distribution of the average and the probability of falling
within 1 centimeter of the population mean. Examination of the
distribution of a sample of a single individual is easy enough. The
total number of outcomes, which is 100,000 in the given example, can be
handled with no effort by the computer. However, when we consider
samples of size 100 we get that the total number of ways to select 100
number out of 100,000 numbers is in the order of <span class="math inline">\(10^{342}\)</span> (1 followed
by 342 zeros) and cannot be handled by any computer. Thus, the
probability cannot be computed.</p>
<p>As a compromise we will approximate the distribution by selecting a
large number of samples, say 100,000, to represent the entire
collection, and use the resulting distribution as an approximation of
the sampling distribution. Indeed, the larger the number of samples that
we create the more accurate the approximation of the distribution is.
Still, taking 100,000 repeats should produce approximations which are
good enough for our purposes.</p>
<p>Consider the sampling distribution of the sample average. We simulated
above a few examples of the average. Now we would like to simulate
100,000 such examples. We do this by creating first a sequence of the
length of the number of evaluations we seek (100,000) and then write a
small program that produces each time a new random sample of size 100
and assigns the value of the average of that sample to the appropriate
position in the sequence. Do first and explain later<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Running this simulation, and similar simulations of the same
nature that will be considered in the sequel, demands more of the
computer’s resources than the examples that were considered up until
now. Beware that running times may be long and, depending on the
strength of your computer and your patience, too long. You may save
time by running less iterations, replacing, say, “&lt;code&gt;10^5&lt;/code&gt;” by
“&lt;code&gt;10^4&lt;/code&gt;”. The results of the simulation will be less accurate, but
will still be meaningful.&lt;/p&gt;"><sup>64</sup></a>:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">Y.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">heights_population</span><span class="op">$</span><span class="va">height</span>,<span class="fl">100</span><span class="op">)</span>
  <span class="va">Y.bar</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In the first line we produce a sequence of length 100,000 that contains
zeros. The function “<code>rep</code>” creates a sequence that contains repeats of
its first argument a number of times that is specified by its second
argument. In this example, the numerical value 0 is repeated 100,000
times to produce a sequence of zeros of the length we seek.</p>
<p>The main part of the program is a “<code>for</code>” loop. The argument of the
function “<code>for</code>” takes the special form: “<em>index.name</em> <code>in</code>
<em>index.values</em>”, where <em>index.name</em> is the name of the running index and
<em>index.values</em> is the collection of values over which the running index
is evaluated. In each iteration of the loop the running index is
assigned a value from the collection and the expression that follows the
brackets of the “<code>for</code>” function is evaluated with the given value of
the running index.</p>
<p>In the given example the collection of values is produced by the
expression “<code>1:n</code>”. Recall that the expression “<code>1:n</code>” produces the
collection of integers between <code>1</code> and <code>n</code>. Here, <code>n</code> = 100,000. Hence,
in the given application the collection of values is a sequence that
contains the integers between 1 and 100,000. The running index is called
“<code>i</code>”. the expression is evaluated 100,000 times, each time with a
different integer value for the running index “<code>i</code>”.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SampDist6"></span>
<img src="11-sampling-dist_files/figure-html/SampDist6-1.png" alt="Distribution of Height and the Sampling Distribution of Averages" width="672"><p class="caption">
Figure 10.1: Distribution of Height and the Sampling Distribution of Averages
</p>
</div>
<p>The <code>R</code> system treats a collection of expressions enclosed within curly
brackets as one entity. Therefore, in each iteration of the “<code>for</code>”
loop, the lines that are within the curly brackets are evaluated. In the
first line a random sample of size 100 is produced and in the second
line the average of the sample is computed and stored in the <span class="math inline">\(i\)</span>-th
position of the sequence “<code>Y.bar</code>”. Observe that the specific position
in the sequence is referred to by using square brackets.</p>
<p>The program changes the original components of the sequence, from 0 to
the average of a random sample, one by one. When the loop ends all
values are changed and the sequence “<code>Y.bar</code>” contains 100,000
evaluations of the sample average. The last line, which is outside the
curly brackets and is evaluated after the “<code>for</code>” loop ends, produces an
histogram of the averages that were simulated. The histogram is
presented in the lower panel of Figure <a href="ChapSampDist.html#fig:SampDist6">10.1</a>.</p>
<p>Compare the distribution of the sample average to the distribution of
the heights in the population that was presented first in
Figure <a href="ChapProbability.html#fig:Prob1">7.2</a> and is currently presented in the upper
panel of Figure <a href="ChapSampDist.html#fig:SampDist6">10.1</a>. Observe that both distributions are
centered at about 170 centimeters. Notice, however, that the range of
values of the sample average lies essentially between 166 and 174
centimeters, whereas the range of the distribution of heights themselves
is between 127 and 217 centimeter. Broadly speaking, the sample average
and the original measurement are centered around the same location but
the sample average is less spread.</p>
<p>Specifically, let us compare the expectation and standard deviation of
the sample average to the expectation and standard deviation of the
original measurement:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">heights_population</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="co">#&gt; [1] 170.035</span>
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">heights_population</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="co">#&gt; [1] 11.23205</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span>
<span class="co">#&gt; [1] 170.0276</span>
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.125938</span></code></pre></div>
<p>Observe that the expectation of the population and the expectation of
the sample average, are practically the same, the standard deviation of
the sample average is about 10 times smaller than the standard deviation
of the population. This result is not accidental and actually reflects a
general phenomena that will be seen below in other examples.</p>
<p>We may use the simulated sampling distribution in order to compute an
approximation of the probability of the sample average falling within 1
centimeter of the population mean. Let us first compute the relevant
probability and then explain the details of the computation:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Y.bar</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">heights_population</span><span class="op">$</span><span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.62556</span></code></pre></div>
<p>Hence we get that the probability of the given event is about 62.6%.</p>
<p>The object “<code>Y.bar</code>” is a sequence of length 100,000 that contains the
simulated sample averages. This sequence represents the distribution of
the sample average. The expression
“<code>abs(Y.bar - mean(heights_population$height)) &lt;= 1</code>” produces a sequence of logical
“<code>TRUE</code>” or “<code>FALSE</code>” values, depending on the value of the sample
average being less or more than one unit away from the population mean.
The application of the function “<code>mean</code>” to the output of the last
expression results in the computation of the relative frequency of
<code>TRUE</code>s, which corresponds to the probability of the event of interest.</p>

<div class="example">
<span id="exm:exsampdist1" class="example"><strong>Example 10.1  </strong></span>Consider a poll for the determination of the support in the
population for a candidate. The proportion in the population of
supporters was denoted by <span class="math inline">\(p\)</span>. A sample of size <span class="math inline">\(n=300\)</span> was considered
in order to estimate the size of <span class="math inline">\(p\)</span>. We identified that the
distribution of <span class="math inline">\(X\)</span>, the number of supporters in the sample, is
<span class="math inline">\(\mathrm{Binomial}(300,p)\)</span>. This distribution is the sampling
distribution<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Mathematically speaking, the Binomial distribution is only an
approximation to the sampling distribution of &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;. Actually, the
Binomial is an exact description to the distribution only in the
case where each subject has the chance be represented in the sample
more than once. However, only when the size of the sample is
comparable to the size of the population would the Binomial
distribution fail to be an adequate approximation to the sampling
distribution.&lt;/p&gt;'><sup>65</sup></a> of <span class="math inline">\(Y\)</span>. One may use the proportion in the sample of
supporters, the number of supporters in the sample divided by 300, as an
estimate to the parameter <span class="math inline">\(p\)</span>. The sampling distribution of this
quantity, <span class="math inline">\(Y/300\)</span>, may be considered in order to assess the discrepancy
between the estimate and the actual value of the parameter.
</div>

</div>
<div id="subsec:theoreticalmdls" class="section level3">
<h3>
<span class="header-section-number">10.2.3</span> Theoretical Models<a class="anchor" aria-label="anchor" href="#subsec:theoreticalmdls"><i class="fas fa-link"></i></a>
</h3>
<p>Sampling distribution can also be considered in the context of
theoretical distribution models. For example, take a measurement
<span class="math inline">\(Y \sim \mathrm{Binomial}(10,0.5)\)</span> from the Binomial distribution.
Assume 64 independent measurements are produced with this distribution:
<span class="math inline">\(Y_1, Y_2, \ldots, Y_{64}\)</span>. The sample average in this case corresponds
to the distribution of the random variable produced by averaging these
64 random variables:</p>
<p><span class="math display">\[\bar Y = \frac{Y_1 + Y_2 + \cdots + Y_{64}} {64} = \frac{1}{64}\sum_{i=1}^{64} Y_i\;.\]</span>
Again, one may wonder what is the distribution of the sample average
<span class="math inline">\(\bar Y\)</span> in this case?</p>
<p>We can approximate the distribution of the sample average by simulation.
The function “<code>rbinom</code>” produces a random sample from the Binomial
distribution. The first argument to the function is the sample size,
which we take in this example to be equal to 64. The second and third
arguments are the parameters of the Binomial distribution, 10 and 0.5 in
this case. We can use this function in the simulation:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">Y.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">64</span>,<span class="fl">10</span>,<span class="fl">0.5</span><span class="op">)</span>
  <span class="va">Y.bar</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Observe that in this code we created a sequence of length 100,000 with
evaluations of the sample average of 64 Binomial random variables. We
start with a sequence of zeros and in each iteration of the “<code>for</code>” loop
a zero is replaced by the average of a random sample of 64 Binomial
random variables.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SampDist7"></span>
<img src="11-sampling-dist_files/figure-html/SampDist7-1.png" alt="Distributions of an Average and a Single Binomial(10,0.5)" width="672"><p class="caption">
Figure 10.2: Distributions of an Average and a Single Binomial(10,0.5)
</p>
</div>
<p>Examine the sampling distribution of the Binomial average:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span>
<span class="co">#&gt; [1] 5.000628</span>
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1976092</span></code></pre></div>
<p>The histogram of the sample average is presented in the lower panel of
Figure <a href="ChapSampDist.html#fig:SampDist7">10.2</a>. Compare it to the distribution of a single
Binomial random variable that appears in the upper panel. Notice, once
more, that the center of the two distributions coincide but the spread
of the sample average is smaller. The sample space of a single Binomial
random variable is composed of integers. The sample space of the average
of 64 Binomial random variables, on the other hand, contains many more
values and is closer to the sample space of a random variable with a
continuous distribution.</p>
<p>Recall that the expectation of a <span class="math inline">\(\mathrm{Binomial}(10,0.5)\)</span> random
variable is <span class="math inline">\(\operatorname{E}(Y) = 10 \cdot 0.5 = 5\)</span> and the variance is
<span class="math inline">\(\operatorname{Var}(Y) = 10 \cdot 0.5 \cdot 0.5 = 2.5\)</span> (thus, the standard deviation
is <span class="math inline">\(\sqrt{2.5} = 1.581139\)</span>). Observe that the expectation of the sample
average that we got from the simulation is essentially equal to 5 and
the standard deviation is 0.1982219.</p>
<p>In Section <a href="randomVariables.html#randomVariables">8</a>, we proved mathematically that the expectation of the sample mean is
equal to the theoretical expectation of its components:</p>
<p><span class="math display">\[\operatorname{E}(\bar Y) = \operatorname{E}(Y)\;.\]</span> The results of the simulation for the
expectation of the sample average are consistent with the mathematical
statement. In Section <a href="randomVariables.html#randomVariables">8</a>, we also proved that the variance of the sample average is equal to the variance of each of the components, divided by the sample size:</p>
<p><span class="math display">\[\operatorname{Var}(\bar Y) = \operatorname{Var}(Y)/n\;,\]</span> here <span class="math inline">\(n\)</span> is the number of observations
in the sample. Specifically, in the Binomial example we get that
<span class="math inline">\(\operatorname{Var}(\bar Y) = 2.5/64\)</span>, since the variance of a Binomial component is
2.5 and there are 64 observations. Consequently, the standard deviation
is <span class="math inline">\(\sqrt{2.5/64} = 0.1976424\)</span>, in agreement, more or less, with the
results of the simulation (that produced 0.1982219 as the standard
deviation).</p>
<p>Consider the problem of identifying the central interval that contains
95% of the distribution. In the Normal distribution we were able to use
the function “<code>qnorm</code>” in order to compute the percentiles of the
theoretical distribution. A function that can be used for the same
purpose for simulated distribution is the function “<code>quantile</code>”. The
first argument to this function is the sequence of simulated values of
the statistic, “<code>Y.bar</code>” in the current case. The second argument is a
number between 0 and 1, or a sequence of such numbers:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Y.bar</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     2.5%    97.5% </span>
<span class="co">#&gt; 4.609375 5.390625</span></code></pre></div>
<p>We used the sequence “<code>c(0.025,0.975)</code>” as the input to the second
argument. As a result we obtained the output 4.609375, which is the
2.5%-percentile of the sampling distribution of the average, and
5.390625, which is the 97.5%-percentile of the sampling distribution of
the average.</p>
<p>Of interest is to compare these percentiles to the parallel percentiles
of the Normal distribution with the same expectation and the same
standard deviation as the average of the Binomials:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y.bar</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 4.613321 5.387935</span></code></pre></div>
<p>Observe the similarity between the percentiles of the distribution of
the average and the percentiles of the Normal distribution. This
similarity is a reflection of the Normal approximation of the sampling
distribution of the average, which is formulated in the next section
under the title: <em>The Central Limit Theorem</em>.</p>

<div class="example">
<span id="exm:exsampdist3" class="example"><strong>Example 10.2  </strong></span>The distribution of the number of events of radio
active decay in a second can be modeled according to the Poisson distribution. A quantity of interest is
<span class="math inline">\(\lambda\)</span>, the expectation of that Poisson distribution. This quantity
may be estimated by measuring the total number of decays over a period
of time and dividing the outcome by the number of seconds in that period
of time. Let <span class="math inline">\(n\)</span> be this number of second. The procedure just described
corresponds to taking the sample average of <span class="math inline">\(\mathrm{Poisson}(\lambda)\)</span>
observations for a sample of size <span class="math inline">\(n\)</span>. The expectation of the sample
average is <span class="math inline">\(\lambda\)</span> and the variance is <span class="math inline">\(\lambda/n\)</span>, leading to a
standard deviation of size <span class="math inline">\(\sqrt{\lambda/n}\)</span>. The Central Limit Theorem
states that the sampling distribution of this average corresponds,
approximately, to the Normal distribution with this expectation and
standard deviation.
</div>

</div>
</div>
<div id="law-of-large-numbers-and-central-limit-theorem" class="section level2">
<h2>
<span class="header-section-number">10.3</span> Law of Large Numbers and Central Limit Theorem<a class="anchor" aria-label="anchor" href="#law-of-large-numbers-and-central-limit-theorem"><i class="fas fa-link"></i></a>
</h2>
<p>The Law of Large Numbers and the Central Limit Theorem are mathematical
theorems that describe the sampling distribution of the average for
large samples.</p>
<div id="the-law-of-large-numbers" class="section level3">
<h3>
<span class="header-section-number">10.3.1</span> The Law of Large Numbers<a class="anchor" aria-label="anchor" href="#the-law-of-large-numbers"><i class="fas fa-link"></i></a>
</h3>
<p>The Law of Large Numbers states that, as the sample size becomes larger,
the sampling distribution of the sample average becomes more and more
concentrated about the expectation.</p>
<p>Let us demonstrate the Law of Large Numbers in the context of the
Uniform distribution. Let the distribution of the measurement <span class="math inline">\(Y\)</span> be
<span class="math inline">\(\mathrm{Uniform}(3,7)\)</span>. Consider three different sample sizes <span class="math inline">\(n\)</span>:
<span class="math inline">\(n=10\)</span>, <span class="math inline">\(n=100\)</span>, and <span class="math inline">\(n=1000\)</span>. Let us carry out a simulation similar to
the simulations of the previous section. However, this time we run the
simulation for the three sample sizes in parallel:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unif.10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="va">unif.100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="va">unif.1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">Y.samp.10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span>
  <span class="va">unif.10</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp.10</span><span class="op">)</span>
  <span class="va">Y.samp.100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span>
  <span class="va">unif.100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp.100</span><span class="op">)</span>
  <span class="va">Y.samp.1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span>
  <span class="va">unif.1000</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y.samp.1000</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Observe that we have produced 3 sequences of length 100,000 each:
“<code>unif.10</code>”, “<code>unif.100</code>”, and “<code>unif.1000</code>”. The first sequence is an
approximation of the sampling distribution of an average of 10
independent Uniform measurements, the second approximates the sampling
distribution of an average of 100 measurements and the third the
distribution of an average of 1000 measurements. The distribution of
single measurement in each of the examples is <span class="math inline">\(\mathrm{Uniform}(3,7)\)</span>.</p>
<p>Consider the expectation of sample average for the three sample sizes:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">unif.10</span><span class="op">)</span>
<span class="co">#&gt; [1] 4.999444</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">unif.100</span><span class="op">)</span>
<span class="co">#&gt; [1] 5.000308</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">unif.1000</span><span class="op">)</span>
<span class="co">#&gt; [1] 5.000169</span></code></pre></div>
<p>For all sample size the expectation of the sample average is equal to 5,
which is the expectation of the <span class="math inline">\(\mathrm{Uniform}(3,7)\)</span> distribution.</p>
<p>Recall that the variance of the <span class="math inline">\(\mathrm{Uniform}(a,b)\)</span> distribution is
<span class="math inline">\((b-a)^2/12\)</span>. Hence, the variance of the given Uniform distribution is
<span class="math inline">\(\operatorname{Var}(X) = (7-3)^2/12 = 16/12 \approx 1.3333\)</span>. The variances of the
sample averages are:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">unif.10</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1332605</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">unif.100</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.01330791</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">unif.1000</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.001339139</span></code></pre></div>
<p>Notice that the variances decrease with the increase of the sample
sizes. The decrease is according to the formula
<span class="math inline">\(\operatorname{Var}(\bar Y) = \operatorname{Var}(Y)/n\)</span>.</p>
<p>The variance is a measure of the spread of the distribution about the
expectation. The smaller the variance the more concentrated is the
distribution around the expectation. Consequently, in agreement with the
Law of Large Numbers, the larger the sample size the more concentrated
is the sampling distribution of the sample average about the
expectation.</p>
</div>
<div id="the-central-limit-theorem-clt" class="section level3">
<h3>
<span class="header-section-number">10.3.2</span> The Central Limit Theorem (CLT)<a class="anchor" aria-label="anchor" href="#the-central-limit-theorem-clt"><i class="fas fa-link"></i></a>
</h3>
<p>The Law of Large Numbers states that the distribution of the sample
average tends to be more concentrated as the sample size increases. The
Central Limit Theorem (CLT in short) provides an approximation of this
distribution.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SampDist8"></span>
<img src="11-sampling-dist_files/figure-html/SampDist8-1.png" alt="The CLT for the Uniform(3,7) Distribution" width="672"><p class="caption">
Figure 10.3: The CLT for the Uniform(3,7) Distribution
</p>
</div>
<p>The deviation between the sample average and the expectation of the
measurement tend to decreases with the increase in sample size. In order
to obtain a refined assessment of this deviation one needs to magnify
it. The appropriate way to obtain the magnification is to consider the
standardized sample average, in which the deviation of the sample
average from its expectation is divided by the standard deviation of the
sample average:</p>
<p><span class="math display">\[Z = \frac{\bar Y - \operatorname{E}(\bar Y)}{\sqrt{\operatorname{Var}(\bar Y)}}\;.\]</span></p>
<p>Recall that the expectation of the sample average is equal to the
expectation of a single random variable (<span class="math inline">\(\operatorname{E}(\bar Y) = \operatorname{E}(Y)\)</span>)
and that the variance of the sample average is equal to the variance of
a single observation, divided by the sample size
(<span class="math inline">\(\operatorname{Var}(\bar Y) = \operatorname{Var}(Y)/n\)</span>). Consequently, one may rewrite the
standardized sample average in the form:</p>
<p><span class="math display">\[Z = \frac{\bar Y - \operatorname{E}(Y)}{\sqrt{\operatorname{Var}(Y)/n}}= \frac{\sqrt{n}(\bar Y - \operatorname{E}(Y))}{\sqrt{\operatorname{Var}(Y)}}\;.\]</span>
The second equality follows from placing in the numerator the square
root of <span class="math inline">\(n\)</span> which <em>divides</em> the term in the denominator. Observe that
with the increase of the sample size the decreasing difference between
the average and the expectation is magnified by the square root of <span class="math inline">\(n\)</span>.</p>
<p>The Central Limit Theorem states that, with the increase in sample size,
the sample average converges (after standardization) to the standard
Normal distribution.</p>
<p>Let us examine the Central Normal Theorem in the context of the example
of the Uniform measurement. In Figure <a href="ChapSampDist.html#fig:SampDist8">10.3</a> you may find
the (approximated) density of the standardized average for the three
sample sizes based on the simulation that we carried out previously (as
<em>red</em>, <em>green</em>, and <em>blue</em> lines). Along side with these densities you
may also find the theoretical density of the standard Normal
distribution (as a <em>black</em> line). Observe that the four curves are
almost one on top of the other, proposing that the approximation of the
distribution of the average by the Normal distribution is good even for
a sample size as small as <span class="math inline">\(n=10\)</span>.</p>
<p>However, before jumping to the conclusion that the Central Limit Theorem
applies to any sample size, let us consider another example. In this
example we repeat the same simulation that we did with the Uniform
distribution, but this time we take <span class="math inline">\(\mathrm{Exponential}(0.5)\)</span>
measurements instead:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp.10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="va">exp.100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="va">exp.1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">X.samp.10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0.5</span><span class="op">)</span>
  <span class="va">exp.10</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X.samp.10</span><span class="op">)</span>
  <span class="va">X.samp.100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0.5</span><span class="op">)</span>
  <span class="va">exp.100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X.samp.100</span><span class="op">)</span>
  <span class="va">X.samp.1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0.5</span><span class="op">)</span>
  <span class="va">exp.1000</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X.samp.1000</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SampDist9"></span>
<img src="11-sampling-dist_files/figure-html/SampDist9-1.png" alt="The CLT for the Exponential(0.5) Distribution" width="60%"><p class="caption">
Figure 10.4: The CLT for the Exponential(0.5) Distribution
</p>
</div>
<p>The expectation of an <span class="math inline">\(\mathrm{Exponential}(0.5)\)</span> random variable is
<span class="math inline">\(\operatorname{E}(X) = 1/\lambda = 1/0.5 = 2\)</span> and the variance is
<span class="math inline">\(\operatorname{Var}(X) = 1/\lambda^2 = 1/(0.5)^2 = 4\)</span>. Observe below that the
expectations of the sample averages are equal to the expectation of the
measurement and the variances of the sample averages follow the relation
<span class="math inline">\(\operatorname{Var}(\bar Y) = \operatorname{Var}(Y)/n\)</span>:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">exp.10</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.9974</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">exp.100</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.999448</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">exp.1000</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.000381</span></code></pre></div>
<p>So the expectations of the sample average are all equal to 2. For the
variance we get:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">exp.10</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.4020298</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">exp.100</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.04006796</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">exp.1000</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.003989475</span></code></pre></div>
<p>Which is in agreement with the decrease proposed by the theory,</p>
<p>However, when one examines the densities of the sample averages in
Figure <a href="ChapSampDist.html#fig:SampDist9">10.4</a> one may see a clear distinction between the
sampling distribution of the average for a sample of size 10 and the
normal distribution (compare the <em>red</em> curve to the <em>black</em> curve. The
match between the <em>green</em> curve that corresponds to a sample of size
<span class="math inline">\(n=100\)</span> and the <em>black</em> line is better, but not perfect. When the sample
size is as large as <span class="math inline">\(n=1000\)</span> (the <em>blue</em> curve) then the agreement with
the normal curve is very good.</p>
</div>
<div id="applying-the-central-limit-theorem" class="section level3">
<h3>
<span class="header-section-number">10.3.3</span> Applying the Central Limit Theorem<a class="anchor" aria-label="anchor" href="#applying-the-central-limit-theorem"><i class="fas fa-link"></i></a>
</h3>
<p>The conclusion of the Central Limit Theorem is that the sampling
distribution of the sample average can be approximated by the Normal
distribution, regardless what is the distribution of the original
measurement, but provided that the sample size is large enough. This
statement is very important, since it allows us, in the context of the
sample average, to carry out probabilistic computations using the Normal
distribution even if we do not know the actual distribution of the
measurement. All we need to know for the computation are the expectation
of the measurement, its variance (or standard deviation) and the sample
size.</p>
<p>The theorem can be applied whenever probability computations associated
with the sampling distribution of the average are required. The
computation of the approximation is carried out by using the Normal
distribution with the same expectation and the same standard deviation
as the sample average.</p>
<p>An example of such computation was conducted in
Subsection <a href="ChapSampDist.html#subsec:theoreticalmdls">10.2.3</a> where the central interval that
contains 95% of the sampling distribution of a Binomial average was
required. The 2.5%- and the 97.5%-percentiles of the Normal distribution
with the same expectation and variance as the sample average produced
boundaries for the interval. These boundaries were in good agreement
with the boundaries produced by the simulation. More examples will be
provided in the Solved Exercises of this chapter and the next one.</p>
<p>With all its usefulness, one should treat the Central Limit Theorem with
a grain of salt. The approximation may be valid for large samples, but
may be bad for samples that are not large enough. When the sample is
small a careless application of the Central Limit Theorem may produce
misleading conclusions.</p>
</div>
</div>
<div id="exercises-3" class="section level2">
<h2>
<span class="header-section-number">10.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-3"><i class="fas fa-link"></i></a>
</h2>
<p>A subatomic particle hits a linear detector at random
locations. The length of the detector is 10 nm and the hits are
uniformly distributed. The location of 25 random hits, measured from a
specified endpoint of the interval, are marked and the average of the
location computed.</p>
<ol style="list-style-type: decimal">
<li>What is the expectation of the average location?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;For a uniformly distributed sample Y, E(&lt;span class="math inline"&gt;\(\bar{Y}\)&lt;/span&gt;) = E(Y) = &lt;span class="math inline"&gt;\(\frac{1}{2} \times\)&lt;/span&gt; 10 = 5&lt;/p&gt;'><sup>66</sup></a>
</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>What is the standard deviation of the average location?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Var(&lt;span class="math inline"&gt;\(\bar{Y}\)&lt;/span&gt;) = &lt;span class="math inline"&gt;\(\frac{1}{n}\)&lt;/span&gt;Var(Y) = &lt;span class="math inline"&gt;\(\frac{1}{25} \times \frac{1}{12}10^2\)&lt;/span&gt; = &lt;span class="math inline"&gt;\(\frac{1}{3}\to\)&lt;/span&gt; sd(&lt;span class="math inline"&gt;\(\bar{Y}\)&lt;/span&gt;) = &lt;span class="math inline"&gt;\(\sqrt{Var(\bar{Y})}\)&lt;/span&gt; = 0.5774&lt;/p&gt;'><sup>67</sup></a>
</li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>Use the Central Limit Theorem in order to approximate the
probability the average location is in the left-most third of the
linear detector.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;P(&lt;span class="math inline"&gt;\(\bar{Y} \leq \frac{1}{3}\)&lt;/span&gt;) = P(&lt;span class="math inline"&gt;\(\frac{\bar{Y}-E(Y)}{\sqrt{Var(Y)/n}} \leq \frac{10/3-E(Y)}{\sqrt{Var(Y)/n}}\)&lt;/span&gt;) = P(&lt;span class="math inline"&gt;\(z \leq \frac{10/3-E(Y)}{sd(\bar{Y})}\)&lt;/span&gt;) = pnorm((10/3-5)/0.5774) = 0.0019&lt;/p&gt;'><sup>68</sup></a>
</li>
</ol>
<ol start="4" style="list-style-type: decimal">
<li>The central region that contains 99% of the distribution of the
average is of the form <span class="math inline">\(5 \pm c\)</span>. Use the Central Limit Theorem in
order to approximate the value of c.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Find &lt;span class="math inline"&gt;\(y_0, y_1\)&lt;/span&gt; such that P(&lt;span class="math inline"&gt;\(y_0 &amp;lt; \bar{Y} &amp;lt; y_1\)&lt;/span&gt;) = 0.99. With the Central Limit Theorem, the distribution of &lt;span class="math inline"&gt;\(\bar{Y}\)&lt;/span&gt; is approximately &lt;span class="math inline"&gt;\(\mathcal{N}(E(Y),sd(\bar{Y}))\)&lt;/span&gt;. Thus, &lt;span class="math inline"&gt;\(y_1\)&lt;/span&gt; = qnorm(0.995,5,0.5774) = 6.487, &lt;span class="math inline"&gt;\(y_0\)&lt;/span&gt; = qnorm(0.005,5,0.5774) = 3.513, c = &lt;span class="math inline"&gt;\(y_1\)&lt;/span&gt; - 5 = 1.487&lt;/p&gt;'><sup>69</sup></a>
</li>
</ol>
</div>
<div id="summary-2" class="section level2">
<h2>
<span class="header-section-number">10.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-2"><i class="fas fa-link"></i></a>
</h2>
<div id="glossary" class="section level3 unnumbered">
<h3>Glossary<a class="anchor" aria-label="anchor" href="#glossary"><i class="fas fa-link"></i></a>
</h3>
<dl>
<dt>Random Sample:</dt>
<dd>
<p>The probabilistic model for the values of a measurements in the
sample, before the measurement is taken.</p>
</dd>
<dt>Sampling Distribution:</dt>
<dd>
<p>The distribution of a random sample.</p>
</dd>
<dt>Sampling Distribution of a Statistic:</dt>
<dd>
<p>A statistic is a function of the data; i.e. a formula applied to the
data. The statistic becomes a random variable when the formula is
applied to a random sample. The distribution of this random
variable, which is inherited from the distribution of the sample, is
its sampling distribution.</p>
</dd>
<dt>Sampling Distribution of the Sample Average:</dt>
<dd>
<p>The distribution of the sample average, considered as a random
variable.</p>
</dd>
<dt>The Law of Large Numbers:</dt>
<dd>
<p>A mathematical result regarding the sampling distribution of the
sample average. States that the distribution of the average of
measurements is highly concentrated in the vicinity of the
expectation of a measurement when the sample size is large.</p>
</dd>
<dt>The Central Limit Theorem:</dt>
<dd>
<p>A mathematical result regarding the sampling distribution of the
sample average. States that the distribution of the average is
approximately Normal when the sample size is large.</p>
</dd>
</dl>
</div>
<div id="summary-of-formulas" class="section level3 unnumbered">
<h3>Summary of Formulas<a class="anchor" aria-label="anchor" href="#summary-of-formulas"><i class="fas fa-link"></i></a>
</h3>
<dl>
<dt>Expectation of the sample average:</dt>
<dd>
<p><span class="math inline">\(\operatorname{E}(\bar Y) = \operatorname{E}(Y)\)</span></p>
</dd>
<dt>Variance of the sample average:</dt>
<dd>
<p><span class="math inline">\(\operatorname{Var}(\bar Y) = \operatorname{Var}(Y)/n\)</span></p>
</dd>
</dl>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="ChapNormal.html"><span class="header-section-number">9</span> The Normal Random Variable</a></div>
<div class="next"><a href="CI.html"><span class="header-section-number">11</span> Parameter Intervals</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ChapSampDist"><span class="header-section-number">10</span> The Sampling Distribution</a></li>
<li><a class="nav-link" href="#student-learning-objective-2"><span class="header-section-number">10.1</span> Student Learning Objective</a></li>
<li>
<a class="nav-link" href="#the-sampling-distribution"><span class="header-section-number">10.2</span> The Sampling Distribution</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#a-random-sample"><span class="header-section-number">10.2.1</span> A Random Sample</a></li>
<li><a class="nav-link" href="#sampling-from-a-population-1"><span class="header-section-number">10.2.2</span> Sampling From a Population</a></li>
<li><a class="nav-link" href="#subsec:theoreticalmdls"><span class="header-section-number">10.2.3</span> Theoretical Models</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#law-of-large-numbers-and-central-limit-theorem"><span class="header-section-number">10.3</span> Law of Large Numbers and Central Limit Theorem</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-law-of-large-numbers"><span class="header-section-number">10.3.1</span> The Law of Large Numbers</a></li>
<li><a class="nav-link" href="#the-central-limit-theorem-clt"><span class="header-section-number">10.3.2</span> The Central Limit Theorem (CLT)</a></li>
<li><a class="nav-link" href="#applying-the-central-limit-theorem"><span class="header-section-number">10.3.3</span> Applying the Central Limit Theorem</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exercises-3"><span class="header-section-number">10.4</span> Exercises</a></li>
<li>
<a class="nav-link" href="#summary-2"><span class="header-section-number">10.5</span> Summary</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#glossary">Glossary</a></li>
<li><a class="nav-link" href="#summary-of-formulas">Summary of Formulas</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EPIB607</strong>" was written by Sahir Bhatnagar and James A Hanley. It was last built on 2021-12-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
